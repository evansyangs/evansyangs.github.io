<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5. Underfitting and Overfitting | evansyangs</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css">
    <meta name="description" content="Southeast University | Mathematics | Complex Network">
    <meta name="robots" content="all">
    <meta name="author" content="Evan Yang">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="keywords" content="evansyangs,Evan Yang,东南大学,数学学院,复杂网络,博客,blog,Python,深度学习,graph">
    <meta name="theme-color" content="#11a8cd">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no,maximum-scale=1.0,minimum-scale=1.0">
    
    <link rel="preload" href="/assets/css/0.styles.16d34b40.css" as="style"><link rel="preload" href="/assets/js/app.f773b411.js" as="script"><link rel="preload" href="/assets/js/2.84387116.js" as="script"><link rel="preload" href="/assets/js/49.d5424c41.js" as="script"><link rel="prefetch" href="/assets/js/10.44d7445a.js"><link rel="prefetch" href="/assets/js/100.b7dd7617.js"><link rel="prefetch" href="/assets/js/101.fa74c789.js"><link rel="prefetch" href="/assets/js/102.78ccbf5b.js"><link rel="prefetch" href="/assets/js/103.4d3649de.js"><link rel="prefetch" href="/assets/js/104.1c73a116.js"><link rel="prefetch" href="/assets/js/105.2adbc65a.js"><link rel="prefetch" href="/assets/js/106.9d243c83.js"><link rel="prefetch" href="/assets/js/107.55fcdd1e.js"><link rel="prefetch" href="/assets/js/108.acf197ba.js"><link rel="prefetch" href="/assets/js/109.a2d9b242.js"><link rel="prefetch" href="/assets/js/11.a5845681.js"><link rel="prefetch" href="/assets/js/110.085d62dc.js"><link rel="prefetch" href="/assets/js/111.f7fa5986.js"><link rel="prefetch" href="/assets/js/112.b9f8f8fa.js"><link rel="prefetch" href="/assets/js/113.6f22c939.js"><link rel="prefetch" href="/assets/js/114.a0336642.js"><link rel="prefetch" href="/assets/js/115.b4f255c1.js"><link rel="prefetch" href="/assets/js/116.31cac6af.js"><link rel="prefetch" href="/assets/js/12.66434846.js"><link rel="prefetch" href="/assets/js/13.3a28537f.js"><link rel="prefetch" href="/assets/js/14.88f8b393.js"><link rel="prefetch" href="/assets/js/15.5426e551.js"><link rel="prefetch" href="/assets/js/16.51a2b860.js"><link rel="prefetch" href="/assets/js/17.58641bea.js"><link rel="prefetch" href="/assets/js/18.623fdd79.js"><link rel="prefetch" href="/assets/js/19.79d27e55.js"><link rel="prefetch" href="/assets/js/20.7e3e5a46.js"><link rel="prefetch" href="/assets/js/21.27b57aab.js"><link rel="prefetch" href="/assets/js/22.137875fc.js"><link rel="prefetch" href="/assets/js/23.265f7613.js"><link rel="prefetch" href="/assets/js/24.af98e2d4.js"><link rel="prefetch" href="/assets/js/25.58f18516.js"><link rel="prefetch" href="/assets/js/26.7dc82795.js"><link rel="prefetch" href="/assets/js/27.e83d9a94.js"><link rel="prefetch" href="/assets/js/28.7280b933.js"><link rel="prefetch" href="/assets/js/29.a6de8923.js"><link rel="prefetch" href="/assets/js/3.5bbbaab9.js"><link rel="prefetch" href="/assets/js/30.12280610.js"><link rel="prefetch" href="/assets/js/31.b401bce2.js"><link rel="prefetch" href="/assets/js/32.a41aa550.js"><link rel="prefetch" href="/assets/js/33.74f77079.js"><link rel="prefetch" href="/assets/js/34.f6bee898.js"><link rel="prefetch" href="/assets/js/35.8ab1d6c8.js"><link rel="prefetch" href="/assets/js/36.82ffd70d.js"><link rel="prefetch" href="/assets/js/37.4ed1a841.js"><link rel="prefetch" href="/assets/js/38.be34326e.js"><link rel="prefetch" href="/assets/js/39.36cac3b5.js"><link rel="prefetch" href="/assets/js/4.1a57c6b1.js"><link rel="prefetch" href="/assets/js/40.117eafb3.js"><link rel="prefetch" href="/assets/js/41.f92660a5.js"><link rel="prefetch" href="/assets/js/42.92ca6c1a.js"><link rel="prefetch" href="/assets/js/43.24d6c834.js"><link rel="prefetch" href="/assets/js/44.459a7f4d.js"><link rel="prefetch" href="/assets/js/45.bf753765.js"><link rel="prefetch" href="/assets/js/46.73396ac5.js"><link rel="prefetch" href="/assets/js/47.fdc5d000.js"><link rel="prefetch" href="/assets/js/48.ddbc6653.js"><link rel="prefetch" href="/assets/js/5.e1170737.js"><link rel="prefetch" href="/assets/js/50.f46c6124.js"><link rel="prefetch" href="/assets/js/51.e875daef.js"><link rel="prefetch" href="/assets/js/52.8b953c20.js"><link rel="prefetch" href="/assets/js/53.5c6f94ef.js"><link rel="prefetch" href="/assets/js/54.5317fba4.js"><link rel="prefetch" href="/assets/js/55.6522561d.js"><link rel="prefetch" href="/assets/js/56.98bed07c.js"><link rel="prefetch" href="/assets/js/57.e778c254.js"><link rel="prefetch" href="/assets/js/58.e34afd97.js"><link rel="prefetch" href="/assets/js/59.732d9aab.js"><link rel="prefetch" href="/assets/js/6.f4073d0d.js"><link rel="prefetch" href="/assets/js/60.d8b1a318.js"><link rel="prefetch" href="/assets/js/61.8a6a8451.js"><link rel="prefetch" href="/assets/js/62.3d3fe79e.js"><link rel="prefetch" href="/assets/js/63.234f8e91.js"><link rel="prefetch" href="/assets/js/64.1b5a8e0c.js"><link rel="prefetch" href="/assets/js/65.7a54d2d7.js"><link rel="prefetch" href="/assets/js/66.d97afc69.js"><link rel="prefetch" href="/assets/js/67.15e81787.js"><link rel="prefetch" href="/assets/js/68.8d6268c4.js"><link rel="prefetch" href="/assets/js/69.e03bdfb1.js"><link rel="prefetch" href="/assets/js/7.8bb46d41.js"><link rel="prefetch" href="/assets/js/70.d3fa8b6d.js"><link rel="prefetch" href="/assets/js/71.9a6c33eb.js"><link rel="prefetch" href="/assets/js/72.f479a007.js"><link rel="prefetch" href="/assets/js/73.05f6d222.js"><link rel="prefetch" href="/assets/js/74.f8265d95.js"><link rel="prefetch" href="/assets/js/75.fb326784.js"><link rel="prefetch" href="/assets/js/76.f4ac48c3.js"><link rel="prefetch" href="/assets/js/77.55a98b8d.js"><link rel="prefetch" href="/assets/js/78.398dd83a.js"><link rel="prefetch" href="/assets/js/79.2919014c.js"><link rel="prefetch" href="/assets/js/8.4a08d6dc.js"><link rel="prefetch" href="/assets/js/80.eacf4199.js"><link rel="prefetch" href="/assets/js/81.f0cc5ad8.js"><link rel="prefetch" href="/assets/js/82.c356758e.js"><link rel="prefetch" href="/assets/js/83.b18db0eb.js"><link rel="prefetch" href="/assets/js/84.cb4f79ea.js"><link rel="prefetch" href="/assets/js/85.e2199493.js"><link rel="prefetch" href="/assets/js/86.dac97b7b.js"><link rel="prefetch" href="/assets/js/87.83c0fa97.js"><link rel="prefetch" href="/assets/js/88.979ba04e.js"><link rel="prefetch" href="/assets/js/89.fbbb74bd.js"><link rel="prefetch" href="/assets/js/9.cd565d1d.js"><link rel="prefetch" href="/assets/js/90.3dd3f7a7.js"><link rel="prefetch" href="/assets/js/91.a510d946.js"><link rel="prefetch" href="/assets/js/92.1e0f20ff.js"><link rel="prefetch" href="/assets/js/93.75a05811.js"><link rel="prefetch" href="/assets/js/94.b3c43bf3.js"><link rel="prefetch" href="/assets/js/95.44ce33cf.js"><link rel="prefetch" href="/assets/js/96.b560aa1e.js"><link rel="prefetch" href="/assets/js/97.6c8f2792.js"><link rel="prefetch" href="/assets/js/98.973fb36c.js"><link rel="prefetch" href="/assets/js/99.18da096b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.16d34b40.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="evansyangs" class="logo"> <span class="site-name can-hide">evansyangs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/evansyangs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://i.loli.net/2020/07/04/QPk6fSMGw4hcz3n.jpg"> <div class="blogger-info"><h3>Evan Yang</h3> <span>摸鱼小能手</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/evansyangs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/e73bea/" class="sidebar-link">Kaggle Micro-Course</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kaggle Python Micro-Course</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Kaggle Machine Learning</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/e9a1de/" class="sidebar-link">Kaggle Machine Learning Micro-Course</a></li><li><a href="/pages/4579c3/" class="sidebar-link">1. How Models Work</a></li><li><a href="/pages/dd59ea/" class="sidebar-link">2. Basic Data Exploration</a></li><li><a href="/pages/d87a4f/" class="sidebar-link">3. Your First Machine Learning Model</a></li><li><a href="/pages/99099a/" class="sidebar-link">4. Model Validation</a></li><li><a href="/pages/36223d/" aria-current="page" class="active sidebar-link">5. Underfitting and Overfitting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/36223d/#_5-1-experimenting-with-different-models" class="sidebar-link">5.1 Experimenting With Different Models</a></li><li class="sidebar-sub-header level2"><a href="/pages/36223d/#_5-2-example" class="sidebar-link">5.2 Example</a></li><li class="sidebar-sub-header level2"><a href="/pages/36223d/#_5-3-conclusion" class="sidebar-link">5.3 Conclusion</a></li><li class="sidebar-sub-header level2"><a href="/pages/36223d/#_5-4-exercise-underfitting-and-overfitting" class="sidebar-link">5.4 Exercise: Underfitting and Overfitting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/36223d/#recap" class="sidebar-link">Recap</a></li><li class="sidebar-sub-header level3"><a href="/pages/36223d/#step-1-compare-different-tree-sizes" class="sidebar-link">Step 1: Compare Different Tree Sizes</a></li><li class="sidebar-sub-header level3"><a href="/pages/36223d/#step-2-fit-model-using-all-data" class="sidebar-link">Step 2: Fit Model Using All Data</a></li></ul></li></ul></li><li><a href="/pages/df4897/" class="sidebar-link">6. Random Forests</a></li><li><a href="/pages/128a52/" class="sidebar-link">7. Exercise Machine Learning Competitions</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="placeholder"></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">5. Underfitting and Overfitting<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>At the end of this step, you will understand the concepts of underfitting and overfitting, and you will be able to apply these ideas to make your models more accurate.</p> <h2 id="_5-1-experimenting-with-different-models"><a href="#_5-1-experimenting-with-different-models" class="header-anchor">#</a> 5.1 Experimenting With Different Models</h2> <p>Now that you have a reliable way to measure model accuracy, you can experiment with alternative models and see which gives the best predictions. But what alternatives do you have for models?</p> <p>You can see in scikit-learn's <a href="http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeRegressor.html" target="_blank" rel="noopener noreferrer">documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> that the decision tree model has many options (more than you'll want or need for a long time). The most important options determine the tree's depth. Recall from <a href="https://www.kaggle.com/dansbecker/how-models-work" target="_blank" rel="noopener noreferrer">the first lesson in this micro-course<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> that a tree's depth is a measure of how many splits it makes before coming to a prediction. This is a relatively shallow tree</p> <center><img src="http://i.imgur.com/R3ywQsR.png" width="80%" height="70%" alt="Depth 2 Tree"></center> <p>In practice, it's not uncommon for a tree to have 10 splits between the top level (all houses) and a leaf. As the tree gets deeper, the dataset gets sliced up into leaves with fewer houses. If a tree only had 1 split, it divides the data into 2 groups. If each group is split again, we would get 4 groups of houses. Splitting each of those again would create 8 groups. If we keep doubling the number of groups by adding more splits at each level, we'll have 210210 groups of houses by the time we get to the 10th level. That's 1024 leaves.</p> <p>When we divide the houses amongst many leaves, we also have fewer houses in each leaf. Leaves with very few houses will make predictions that are quite close to those homes' actual values, but they may make very unreliable predictions for new data (because each prediction is based on only a few houses).</p> <p>This is a phenomenon called <strong>overfitting</strong>, where a model matches the training data almost perfectly, but does poorly in validation and other new data. On the flip side, if we make our tree very shallow, it doesn't divide up the houses into very distinct groups.</p> <p>At an extreme, if a tree divides houses into only 2 or 4, each group still has a wide variety of houses. Resulting predictions may be far off for most houses, even in the training data (and it will be bad in validation too for the same reason). When a model fails to capture important distinctions and patterns in the data, so it performs poorly even in training data, that is called <strong>underfitting</strong>.</p> <p>Since we care about accuracy on new data, which we estimate from our validation data, we want to find the sweet spot between underfitting and overfitting. Visually, we want the low point of the (red) validation curve in</p> <center><img src="http://i.imgur.com/2q85n9s.png" width="60%" height="50%" alt="underfitting_overfitting"></center> <h2 id="_5-2-example"><a href="#_5-2-example" class="header-anchor">#</a> 5.2 Example</h2> <p>There are a few alternatives for controlling the tree depth, and many allow for some routes through the tree to have greater depth than other routes. But the <em>max_leaf_nodes</em> argument provides a very sensible way to control overfitting vs underfitting. The more leaves we allow the model to make, the more we move from the underfitting area in the above graph to the overfitting area.</p> <p>We can use a utility function to help compare MAE scores from different values for <em>max_leaf_nodes</em>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_absolute_error
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeRegressor

<span class="token keyword">def</span> <span class="token function">get_mae</span><span class="token punctuation">(</span>max_leaf_nodes<span class="token punctuation">,</span> train_X<span class="token punctuation">,</span> val_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> val_y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>max_leaf_nodes<span class="token operator">=</span>max_leaf_nodes<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_X<span class="token punctuation">,</span> train_y<span class="token punctuation">)</span>
    preds_val <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>val_X<span class="token punctuation">)</span>
    mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>val_y<span class="token punctuation">,</span> preds_val<span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>mae<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The data is loaded into <strong>train_X</strong>, <strong>val_X</strong>, <strong>train_y</strong> and <strong>val_y</strong> using the code you've already seen (and which you've already written).</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Data Loading Code Runs At This Point</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
    
<span class="token comment"># Load data</span>
melbourne_file_path <span class="token operator">=</span> <span class="token string">'../input/melbourne-housing-snapshot/melb_data.csv'</span>
melbourne_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>melbourne_file_path<span class="token punctuation">)</span> 
<span class="token comment"># Filter rows with missing values</span>
filtered_melbourne_data <span class="token operator">=</span> melbourne_data<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># Choose target and features</span>
y <span class="token operator">=</span> filtered_melbourne_data<span class="token punctuation">.</span>Price
melbourne_features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Rooms'</span><span class="token punctuation">,</span> <span class="token string">'Bathroom'</span><span class="token punctuation">,</span> <span class="token string">'Landsize'</span><span class="token punctuation">,</span> <span class="token string">'BuildingArea'</span><span class="token punctuation">,</span> 
                        <span class="token string">'YearBuilt'</span><span class="token punctuation">,</span> <span class="token string">'Lattitude'</span><span class="token punctuation">,</span> <span class="token string">'Longtitude'</span><span class="token punctuation">]</span>
X <span class="token operator">=</span> filtered_melbourne_data<span class="token punctuation">[</span>melbourne_features<span class="token punctuation">]</span>

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token comment"># split data into training and validation data, for both features and target</span>
train_X<span class="token punctuation">,</span> val_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> val_y <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span>random_state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>We can use a for-loop to compare the accuracy of models built with different values for <em>max_leaf_nodes.</em></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># compare MAE with differing values of max_leaf_nodes</span>
<span class="token keyword">for</span> max_leaf_nodes <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    my_mae <span class="token operator">=</span> get_mae<span class="token punctuation">(</span>max_leaf_nodes<span class="token punctuation">,</span> train_X<span class="token punctuation">,</span> val_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> val_y<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Max leaf nodes: %d  \t\t Mean Absolute Error:  %d&quot;</span> <span class="token operator">%</span><span class="token punctuation">(</span>max_leaf_nodes<span class="token punctuation">,</span> my_mae<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Of the options listed, 500 is the optimal number of leaves.</p> <h2 id="_5-3-conclusion"><a href="#_5-3-conclusion" class="header-anchor">#</a> 5.3 Conclusion</h2> <p>Here's the takeaway: Models can suffer from either:</p> <ul><li><strong>Overfitting:</strong> capturing spurious patterns that won't recur in the future, leading to less accurate predictions, or</li> <li><strong>Underfitting:</strong> failing to capture relevant patterns, again leading to less accurate predictions.</li></ul> <p>We use <strong>validation</strong> data, which isn't used in model training, to measure a candidate model's accuracy. This lets us try many candidate models and keep the best one.</p> <h2 id="_5-4-exercise-underfitting-and-overfitting"><a href="#_5-4-exercise-underfitting-and-overfitting" class="header-anchor">#</a> 5.4 Exercise: Underfitting and Overfitting</h2> <p>Try <strong><a href="https://www.kaggle.com/kernels/fork/1259126" target="_blank" rel="noopener noreferrer">optimizing the model you've previously built<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>.</p> <h3 id="recap"><a href="#recap" class="header-anchor">#</a> Recap</h3> <p>You've built your first model, and now it's time to optimize the size of the tree to make better predictions. Run this cell to set up your coding environment where the previous step left off.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Code you have previously used to load data</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_absolute_error
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeRegressor


<span class="token comment"># Path of the file to read</span>
iowa_file_path <span class="token operator">=</span> <span class="token string">'../input/home-data-for-ml-course/train.csv'</span>

home_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>iowa_file_path<span class="token punctuation">)</span>
<span class="token comment"># Create target object and call it y</span>
y <span class="token operator">=</span> home_data<span class="token punctuation">.</span>SalePrice
<span class="token comment"># Create X</span>
features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'LotArea'</span><span class="token punctuation">,</span> <span class="token string">'YearBuilt'</span><span class="token punctuation">,</span> <span class="token string">'1stFlrSF'</span><span class="token punctuation">,</span> <span class="token string">'2ndFlrSF'</span><span class="token punctuation">,</span> <span class="token string">'FullBath'</span><span class="token punctuation">,</span> <span class="token string">'BedroomAbvGr'</span><span class="token punctuation">,</span> <span class="token string">'TotRmsAbvGrd'</span><span class="token punctuation">]</span>
X <span class="token operator">=</span> home_data<span class="token punctuation">[</span>features<span class="token punctuation">]</span>

<span class="token comment"># Split into validation and training data</span>
train_X<span class="token punctuation">,</span> val_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> val_y <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># Specify Model</span>
iowa_model <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># Fit Model</span>
iowa_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_X<span class="token punctuation">,</span> train_y<span class="token punctuation">)</span>

<span class="token comment"># Make validation predictions and calculate mean absolute error</span>
val_predictions <span class="token operator">=</span> iowa_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>val_X<span class="token punctuation">)</span>
val_mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>val_predictions<span class="token punctuation">,</span> val_y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Validation MAE: {:,.0f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>val_mae<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Set up code checking</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>core <span class="token keyword">import</span> binder
binder<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>machine_learning<span class="token punctuation">.</span>ex5 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nSetup complete&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>You could write the function <code>get_mae</code> yourself. For now, we'll supply it. This is the same function you read about in the previous lesson. Just run the cell below.</p> <h3 id="step-1-compare-different-tree-sizes"><a href="#step-1-compare-different-tree-sizes" class="header-anchor">#</a> Step 1: Compare Different Tree Sizes</h3> <p>Write a loop that tries the following values for <em>max_leaf_nodes</em> from a set of possible values.</p> <p>Call the <em>get_mae</em> function on each value of max_leaf_nodes. Store the output in some way that allows you to select the value of <code>max_leaf_nodes</code> that gives the most accurate model on your data.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_mae</span><span class="token punctuation">(</span>max_leaf_nodes<span class="token punctuation">,</span> train_X<span class="token punctuation">,</span> val_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> val_y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>max_leaf_nodes<span class="token operator">=</span>max_leaf_nodes<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_X<span class="token punctuation">,</span> train_y<span class="token punctuation">)</span>
    preds_val <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>val_X<span class="token punctuation">)</span>
    mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>val_y<span class="token punctuation">,</span> preds_val<span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>mae<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>candidate_max_leaf_nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">]</span>
<span class="token comment"># Write loop to find the ideal tree size from candidate_max_leaf_nodes</span>
mae_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> max_leaf_nodes <span class="token keyword">in</span> candidate_max_leaf_nodes<span class="token punctuation">:</span>
    mae_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>get_mae<span class="token punctuation">(</span>max_leaf_nodes<span class="token punctuation">,</span> train_X<span class="token punctuation">,</span> val_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> val_y<span class="token punctuation">)</span><span class="token punctuation">)</span>

min_mae<span class="token operator">=</span><span class="token builtin">min</span><span class="token punctuation">(</span>mae_list<span class="token punctuation">)</span>
min_mae_index<span class="token operator">=</span>mae_list<span class="token punctuation">.</span>index<span class="token punctuation">(</span>min_mae<span class="token punctuation">)</span>

<span class="token comment"># Store the best value of max_leaf_nodes (it will be either 5, 25, 50, 100, 250 or 500)</span>
best_tree_size <span class="token operator">=</span> candidate_max_leaf_nodes<span class="token punctuation">[</span>min_mae_index<span class="token punctuation">]</span>

step_1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Here is a short solution with a dict comprehension.</span>
<span class="token comment"># The lesson gives an example of how to do this with an explicit loop.</span>
scores <span class="token operator">=</span> <span class="token punctuation">{</span>leaf_size<span class="token punctuation">:</span> get_mae<span class="token punctuation">(</span>leaf_size<span class="token punctuation">,</span> train_X<span class="token punctuation">,</span> val_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> val_y<span class="token punctuation">)</span> <span class="token keyword">for</span> leaf_size <span class="token keyword">in</span> candidate_max_leaf_nodes<span class="token punctuation">}</span>
best_tree_size <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>scores<span class="token punctuation">,</span> key<span class="token operator">=</span>scores<span class="token punctuation">.</span>get<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="step-2-fit-model-using-all-data"><a href="#step-2-fit-model-using-all-data" class="header-anchor">#</a> Step 2: Fit Model Using All Data</h3> <p>You know the best tree size. If you were going to deploy this model in practice, you would make it even more accurate by using all of the data and keeping that tree size.  That is, you don't need to hold out the validation data now that you've made all your modeling decisions.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Fill in argument to make optimal size and uncomment</span>
final_model <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>max_leaf_nodes<span class="token operator">=</span>best_tree_size<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># fit the final model and uncomment the next two lines</span>
final_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
step_2<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>You've tuned this model and improved your results. But we are still using Decision Tree models, which are not very sophisticated by modern machine learning standards. In the next step you will learn to use Random Forests to improve your models even more.</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/evansyangs/Blog-source-code/edit/vuepress-vdoing/docs/Kaggle微课程/02.Kaggle Machine Learning/05.Underfitting and Overfitting.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0" title="标签">#机器学习</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/02/16, 02:45:37</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/99099a/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">4. Model Validation</div></a> <a href="/pages/df4897/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">6. Random Forests</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/99099a/" class="prev">4. Model Validation</a></span> <span class="next"><a href="/pages/df4897/">6. Random Forests</a>→
      </span></p></div></div></div> <div class="article-list no-article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/98bc36/"><div>
            Dell7472黑苹果
            <!----></div></a> <span class="date">03-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/4ca485/"><div>
            上手HackMD
            <!----></div></a> <span class="date">04-13</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/5ce1a4/"><div>
            Windows Terminal设置
            <!----></div></a> <span class="date">03-14</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:isevansyangs@outlook.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/evansyangs" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=634517784" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>Evan Yang</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.f773b411.js" defer></script><script src="/assets/js/2.84387116.js" defer></script><script src="/assets/js/49.d5424c41.js" defer></script>
  </body>
</html>
