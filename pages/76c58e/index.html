<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kaggle Pandas Micro-Course | evansyangs</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css">
    <meta name="description" content="Southeast University | Mathematics | Complex Network">
    <meta name="robots" content="all">
    <meta name="author" content="Evan Yang">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="keywords" content="evansyangs,Evan Yang,东南大学,数学学院,复杂网络,博客,blog,Python,深度学习,graph">
    <meta name="theme-color" content="#11a8cd">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no,maximum-scale=1.0,minimum-scale=1.0">
    
    <link rel="preload" href="/assets/css/0.styles.16d34b40.css" as="style"><link rel="preload" href="/assets/js/app.f773b411.js" as="script"><link rel="preload" href="/assets/js/2.84387116.js" as="script"><link rel="preload" href="/assets/js/71.9a6c33eb.js" as="script"><link rel="prefetch" href="/assets/js/10.44d7445a.js"><link rel="prefetch" href="/assets/js/100.b7dd7617.js"><link rel="prefetch" href="/assets/js/101.fa74c789.js"><link rel="prefetch" href="/assets/js/102.78ccbf5b.js"><link rel="prefetch" href="/assets/js/103.4d3649de.js"><link rel="prefetch" href="/assets/js/104.1c73a116.js"><link rel="prefetch" href="/assets/js/105.2adbc65a.js"><link rel="prefetch" href="/assets/js/106.9d243c83.js"><link rel="prefetch" href="/assets/js/107.55fcdd1e.js"><link rel="prefetch" href="/assets/js/108.acf197ba.js"><link rel="prefetch" href="/assets/js/109.a2d9b242.js"><link rel="prefetch" href="/assets/js/11.a5845681.js"><link rel="prefetch" href="/assets/js/110.085d62dc.js"><link rel="prefetch" href="/assets/js/111.f7fa5986.js"><link rel="prefetch" href="/assets/js/112.b9f8f8fa.js"><link rel="prefetch" href="/assets/js/113.6f22c939.js"><link rel="prefetch" href="/assets/js/114.a0336642.js"><link rel="prefetch" href="/assets/js/115.b4f255c1.js"><link rel="prefetch" href="/assets/js/116.31cac6af.js"><link rel="prefetch" href="/assets/js/12.66434846.js"><link rel="prefetch" href="/assets/js/13.3a28537f.js"><link rel="prefetch" href="/assets/js/14.88f8b393.js"><link rel="prefetch" href="/assets/js/15.5426e551.js"><link rel="prefetch" href="/assets/js/16.51a2b860.js"><link rel="prefetch" href="/assets/js/17.58641bea.js"><link rel="prefetch" href="/assets/js/18.623fdd79.js"><link rel="prefetch" href="/assets/js/19.79d27e55.js"><link rel="prefetch" href="/assets/js/20.7e3e5a46.js"><link rel="prefetch" href="/assets/js/21.27b57aab.js"><link rel="prefetch" href="/assets/js/22.137875fc.js"><link rel="prefetch" href="/assets/js/23.265f7613.js"><link rel="prefetch" href="/assets/js/24.af98e2d4.js"><link rel="prefetch" href="/assets/js/25.58f18516.js"><link rel="prefetch" href="/assets/js/26.7dc82795.js"><link rel="prefetch" href="/assets/js/27.e83d9a94.js"><link rel="prefetch" href="/assets/js/28.7280b933.js"><link rel="prefetch" href="/assets/js/29.a6de8923.js"><link rel="prefetch" href="/assets/js/3.5bbbaab9.js"><link rel="prefetch" href="/assets/js/30.12280610.js"><link rel="prefetch" href="/assets/js/31.b401bce2.js"><link rel="prefetch" href="/assets/js/32.a41aa550.js"><link rel="prefetch" href="/assets/js/33.74f77079.js"><link rel="prefetch" href="/assets/js/34.f6bee898.js"><link rel="prefetch" href="/assets/js/35.8ab1d6c8.js"><link rel="prefetch" href="/assets/js/36.82ffd70d.js"><link rel="prefetch" href="/assets/js/37.4ed1a841.js"><link rel="prefetch" href="/assets/js/38.be34326e.js"><link rel="prefetch" href="/assets/js/39.36cac3b5.js"><link rel="prefetch" href="/assets/js/4.1a57c6b1.js"><link rel="prefetch" href="/assets/js/40.117eafb3.js"><link rel="prefetch" href="/assets/js/41.f92660a5.js"><link rel="prefetch" href="/assets/js/42.92ca6c1a.js"><link rel="prefetch" href="/assets/js/43.24d6c834.js"><link rel="prefetch" href="/assets/js/44.459a7f4d.js"><link rel="prefetch" href="/assets/js/45.bf753765.js"><link rel="prefetch" href="/assets/js/46.73396ac5.js"><link rel="prefetch" href="/assets/js/47.fdc5d000.js"><link rel="prefetch" href="/assets/js/48.ddbc6653.js"><link rel="prefetch" href="/assets/js/49.d5424c41.js"><link rel="prefetch" href="/assets/js/5.e1170737.js"><link rel="prefetch" href="/assets/js/50.f46c6124.js"><link rel="prefetch" href="/assets/js/51.e875daef.js"><link rel="prefetch" href="/assets/js/52.8b953c20.js"><link rel="prefetch" href="/assets/js/53.5c6f94ef.js"><link rel="prefetch" href="/assets/js/54.5317fba4.js"><link rel="prefetch" href="/assets/js/55.6522561d.js"><link rel="prefetch" href="/assets/js/56.98bed07c.js"><link rel="prefetch" href="/assets/js/57.e778c254.js"><link rel="prefetch" href="/assets/js/58.e34afd97.js"><link rel="prefetch" href="/assets/js/59.732d9aab.js"><link rel="prefetch" href="/assets/js/6.f4073d0d.js"><link rel="prefetch" href="/assets/js/60.d8b1a318.js"><link rel="prefetch" href="/assets/js/61.8a6a8451.js"><link rel="prefetch" href="/assets/js/62.3d3fe79e.js"><link rel="prefetch" href="/assets/js/63.234f8e91.js"><link rel="prefetch" href="/assets/js/64.1b5a8e0c.js"><link rel="prefetch" href="/assets/js/65.7a54d2d7.js"><link rel="prefetch" href="/assets/js/66.d97afc69.js"><link rel="prefetch" href="/assets/js/67.15e81787.js"><link rel="prefetch" href="/assets/js/68.8d6268c4.js"><link rel="prefetch" href="/assets/js/69.e03bdfb1.js"><link rel="prefetch" href="/assets/js/7.8bb46d41.js"><link rel="prefetch" href="/assets/js/70.d3fa8b6d.js"><link rel="prefetch" href="/assets/js/72.f479a007.js"><link rel="prefetch" href="/assets/js/73.05f6d222.js"><link rel="prefetch" href="/assets/js/74.f8265d95.js"><link rel="prefetch" href="/assets/js/75.fb326784.js"><link rel="prefetch" href="/assets/js/76.f4ac48c3.js"><link rel="prefetch" href="/assets/js/77.55a98b8d.js"><link rel="prefetch" href="/assets/js/78.398dd83a.js"><link rel="prefetch" href="/assets/js/79.2919014c.js"><link rel="prefetch" href="/assets/js/8.4a08d6dc.js"><link rel="prefetch" href="/assets/js/80.eacf4199.js"><link rel="prefetch" href="/assets/js/81.f0cc5ad8.js"><link rel="prefetch" href="/assets/js/82.c356758e.js"><link rel="prefetch" href="/assets/js/83.b18db0eb.js"><link rel="prefetch" href="/assets/js/84.cb4f79ea.js"><link rel="prefetch" href="/assets/js/85.e2199493.js"><link rel="prefetch" href="/assets/js/86.dac97b7b.js"><link rel="prefetch" href="/assets/js/87.83c0fa97.js"><link rel="prefetch" href="/assets/js/88.979ba04e.js"><link rel="prefetch" href="/assets/js/89.fbbb74bd.js"><link rel="prefetch" href="/assets/js/9.cd565d1d.js"><link rel="prefetch" href="/assets/js/90.3dd3f7a7.js"><link rel="prefetch" href="/assets/js/91.a510d946.js"><link rel="prefetch" href="/assets/js/92.1e0f20ff.js"><link rel="prefetch" href="/assets/js/93.75a05811.js"><link rel="prefetch" href="/assets/js/94.b3c43bf3.js"><link rel="prefetch" href="/assets/js/95.44ce33cf.js"><link rel="prefetch" href="/assets/js/96.b560aa1e.js"><link rel="prefetch" href="/assets/js/97.6c8f2792.js"><link rel="prefetch" href="/assets/js/98.973fb36c.js"><link rel="prefetch" href="/assets/js/99.18da096b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.16d34b40.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="evansyangs" class="logo"> <span class="site-name can-hide">evansyangs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/evansyangs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://i.loli.net/2020/07/04/QPk6fSMGw4hcz3n.jpg"> <div class="blogger-info"><h3>Evan Yang</h3> <span>摸鱼小能手</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/evansyangs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Kaggle Pandas Micro-Course</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/76c58e/#_1-creating-reading-and-writing" class="sidebar-link">1. Creating, Reading and Writing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#getting-started" class="sidebar-link">Getting started</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#creating-data" class="sidebar-link">Creating data</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#reading-data-files" class="sidebar-link">Reading data files</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#exercise-creating-reading-and-writing" class="sidebar-link">Exercise: Creating, Reading and Writing</a></li></ul></li><li><a href="/pages/76c58e/#_2-indexing-selecting-assigning" class="sidebar-link">2. Indexing, Selecting &amp; Assigning</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#introduction-3" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#naive-accessors" class="sidebar-link">Naive accessors</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#indexing-in-pandas" class="sidebar-link">Indexing in pandas</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#manipulating-the-index" class="sidebar-link">Manipulating the index</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#conditional-selection" class="sidebar-link">Conditional selection</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#assigning-data" class="sidebar-link">Assigning data</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#exercise-indexing-selecting-assigning" class="sidebar-link">Exercise: Indexing, Selecting &amp; Assigning</a></li></ul></li><li><a href="/pages/76c58e/#_3-summary-functions-and-maps" class="sidebar-link">3. Summary Functions and Maps</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#introduction-5" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#summary-functions" class="sidebar-link">Summary functions</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#maps" class="sidebar-link">Maps</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#exercise-summary-functions-and-maps" class="sidebar-link">Exercise: Summary Functions and Maps</a></li></ul></li><li><a href="/pages/76c58e/#_4-grouping-and-sorting" class="sidebar-link">4. Grouping and Sorting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#introduction-7" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#groupwise-analysis" class="sidebar-link">Groupwise analysis</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#multi-indexes" class="sidebar-link">Multi-indexes</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#sorting" class="sidebar-link">Sorting</a></li><li class="sidebar-sub-header level3"><a href="/pages/76c58e/#exercise-grouping-and-sorting" class="sidebar-link">Exercise: Grouping and Sorting</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="placeholder"></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Kaggle Pandas Micro-Course<!----></h1> <!----> <div class="theme-vdoing-content content__default"><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>Short hands-on challenges to perfect your data manipulation skills.</p></div> <h2 id="_1-creating-reading-and-writing"><a href="#_1-creating-reading-and-writing" class="header-anchor">#</a> 1. Creating, Reading and Writing</h2> <h3 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h3> <p>In this micro-course, you'll learn all about <strong><a href="https://pandas.pydata.org/" target="_blank" rel="noopener noreferrer">pandas<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>, the most popular Python library for data analysis.</p> <p>Along the way, you'll complete several hands-on exercises with real-world data. We recommend that you work on the exercises while reading the corresponding tutorials.</p> <p><strong>To start the first exercise, please click <a href="https://www.kaggle.com/kernels/fork/587970" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</strong></p> <p>In this tutorial, you will learn how to create your own data, along with how to work with data that already exists.</p> <h3 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting started</h3> <p>To use pandas, you'll typically start with the following line of code.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="creating-data"><a href="#creating-data" class="header-anchor">#</a> Creating data</h3> <p>There are two core objects in pandas: the <strong>DataFrame</strong> and the <strong>Series</strong>.</p> <h4 id="dataframe"><a href="#dataframe" class="header-anchor">#</a> DataFrame</h4> <p>A DataFrame is a table. It contains an array of individual <em>entries</em>, each of which has a certain <em>value</em>. Each entry corresponds to a row (or <em>record</em>) and a <em>column</em>.</p> <p>For example, consider the following simple DataFrame:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Yes'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'No'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>In this example, the &quot;0, No&quot; entry has the value of 131. The &quot;0, Yes&quot; entry has a value of 50, and so on.</p> <p>DataFrame entries are not limited to integers. For instance, here's a DataFrame whose values are strings:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Bob'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'I liked it.'</span><span class="token punctuation">,</span> <span class="token string">'It was awful.'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Sue'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Pretty good.'</span><span class="token punctuation">,</span> <span class="token string">'Bland.'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>We are using the <code>pd.DataFrame()</code> constructor to generate these DataFrame objects. The syntax for declaring a new one is a dictionary whose keys are the column names (<code>Bob</code> and <code>Sue</code> in this example), and whose values are a list of entries. This is the standard way of constructing a new DataFrame, and the one you are most likely to encounter.</p> <p>The dictionary-list constructor assigns values to the <em>column labels</em>, but just uses an ascending count from 0 (0, 1, 2, 3, ...) for the <em>row labels</em>. Sometimes this is OK, but oftentimes we will want to assign these labels ourselves.</p> <p>The list of row labels used in a DataFrame is known as an <strong>Index</strong>. We can assign values to it by using an <code>index</code> parameter in our constructor:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Bob'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'I liked it.'</span><span class="token punctuation">,</span> <span class="token string">'It was awful.'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
              <span class="token string">'Sue'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Pretty good.'</span><span class="token punctuation">,</span> <span class="token string">'Bland.'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
             index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Product A'</span><span class="token punctuation">,</span> <span class="token string">'Product B'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="series"><a href="#series" class="header-anchor">#</a> Series</h4> <p>A Series, by contrast, is a sequence of data values. If a DataFrame is a table, a Series is a list. And in fact you can create one with nothing more than a list:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>A Series is, in essence, a single column of a DataFrame. So you can assign column values to the Series the same way as before, using an <code>index</code> parameter. However, a Series does not have a column name, it only has one overall <code>name</code>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'2015 Sales'</span><span class="token punctuation">,</span> <span class="token string">'2016 Sales'</span><span class="token punctuation">,</span> <span class="token string">'2017 Sales'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Product A'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The Series and the DataFrame are intimately related. It's helpful to think of a DataFrame as actually being just a bunch of Series &quot;glued together&quot;. We'll see more of this in the next section of this tutorial.</p> <h3 id="reading-data-files"><a href="#reading-data-files" class="header-anchor">#</a> Reading data files</h3> <p>Being able to create a DataFrame or Series by hand is handy. But, most of the time, we won't actually be creating our own data by hand. Instead, we'll be working with data that already exists.</p> <p>Data can be stored in any of a number of different forms and formats. By far the most basic of these is the humble CSV file. When you open a CSV file you get something that looks like this:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>Product A<span class="token punctuation">,</span>Product B<span class="token punctuation">,</span>Product C<span class="token punctuation">,</span>
<span class="token number">30</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span>
<span class="token number">35</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>
<span class="token number">41</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">11</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>So a CSV file is a table of values separated by commas. Hence the name: &quot;Comma-Separated Values&quot;, or CSV.</p> <p>Let's now set aside our toy datasets and see what a real dataset looks like when we read it into a DataFrame. We'll use the <code>pd.read_csv()</code> function to read the data into a DataFrame. This goes thusly:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>wine_reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;../input/wine-reviews/winemag-data-130k-v2.csv&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>We can use the <code>shape</code> attribute to check how large the resulting DataFrame is:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>wine_reviews<span class="token punctuation">.</span>shape
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>So our new DataFrame has 130,000 records split across 14 different columns. That's almost 2 million entries!</p> <p>We can examine the contents of the resultant DataFrame using the <code>head()</code> command, which grabs the first five rows:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>wine_reviews<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The <code>pd.read_csv()</code> function is well-endowed, with over 30 optional parameters you can specify. For example, you can see in this dataset that the CSV file has a built-in index, which pandas did not pick up on automatically. To make pandas use that column for the index (instead of creating a new one from scratch), we can specify an <code>index_col</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>wine_reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;../input/wine-reviews/winemag-data-130k-v2.csv&quot;</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
wine_reviews<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="exercise-creating-reading-and-writing"><a href="#exercise-creating-reading-and-writing" class="header-anchor">#</a> Exercise: Creating, Reading and Writing</h3> <p>If you haven't started the exercise, you can <strong><a href="https://www.kaggle.com/kernels/fork/587970" target="_blank" rel="noopener noreferrer">get started here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>.</p> <h4 id="introduction-2"><a href="#introduction-2" class="header-anchor">#</a> Introduction</h4> <p>The first step in most data analytics projects is reading the data file. In this exercise, you'll create Series and DataFrame objects, both by hand and by reading data files.</p> <p>Run the code cell below to load libraries you will need (including code to check your answers).</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'max_rows'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>core <span class="token keyword">import</span> binder<span class="token punctuation">;</span> binder<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>pandas<span class="token punctuation">.</span>creating_reading_and_writing <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup complete.&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_1"><a href="#_1" class="header-anchor">#</a> 1.</h4> <p>In the cell below, create a DataFrame <code>fruits</code> that looks like this:</p> <p><img src="https://i.imgur.com/Ax3pp2A.png" alt=""></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code goes here. Create a dataframe matching the above diagram and assign it to the variable fruits.</span>
fruits <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Apples'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                       <span class="token string">'Bananas'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
q1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
fruits
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>fruits <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apples'</span><span class="token punctuation">,</span> <span class="token string">'Bananas'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2"><a href="#_2" class="header-anchor">#</a> 2.</h4> <p>Create a dataframe <code>fruit_sales</code> that matches the diagram below:</p> <p><img src="https://i.imgur.com/CHPn7ZF.png" alt=""></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code goes here. Create a dataframe matching the above diagram and assign it to the variable fruit_sales.</span>
fruit_sales <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Apples'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                            <span class="token string">'Bananas'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                          index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'2017 Sales'</span><span class="token punctuation">,</span><span class="token string">'2018 Sales'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

q2<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
fruit_sales
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>fruit_sales <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apples'</span><span class="token punctuation">,</span> <span class="token string">'Bananas'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'2017 Sales'</span><span class="token punctuation">,</span> <span class="token string">'2018 Sales'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3"><a href="#_3" class="header-anchor">#</a> 3.</h4> <p>Create a variable <code>ingredients</code> with a Series that looks like:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>Flour     <span class="token number">4</span> cups
Milk       <span class="token number">1</span> cup
Eggs     <span class="token number">2</span> large
Spam       <span class="token number">1</span> can
Name<span class="token punctuation">:</span> Dinner<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>ingredients <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'4 cups'</span><span class="token punctuation">,</span> <span class="token string">'1 cup'</span><span class="token punctuation">,</span> <span class="token string">'2 large'</span><span class="token punctuation">,</span> <span class="token string">'1 can'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Flour'</span><span class="token punctuation">,</span> <span class="token string">'Milk'</span><span class="token punctuation">,</span> <span class="token string">'Eggs'</span><span class="token punctuation">,</span> <span class="token string">'Spam'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Dinner'</span><span class="token punctuation">)</span>

q3<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
ingredients
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>quantities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'4 cups'</span><span class="token punctuation">,</span> <span class="token string">'1 cup'</span><span class="token punctuation">,</span> <span class="token string">'2 large'</span><span class="token punctuation">,</span> <span class="token string">'1 can'</span><span class="token punctuation">]</span>
items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Flour'</span><span class="token punctuation">,</span> <span class="token string">'Milk'</span><span class="token punctuation">,</span> <span class="token string">'Eggs'</span><span class="token punctuation">,</span> <span class="token string">'Spam'</span><span class="token punctuation">]</span>
recipe <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>quantities<span class="token punctuation">,</span> index<span class="token operator">=</span>items<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Dinner'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_4"><a href="#_4" class="header-anchor">#</a> 4.</h4> <p>Read the following csv dataset of wine reviews into a DataFrame called <code>reviews</code>:</p> <p><img src="https://i.imgur.com/74RCZtU.png" alt=""></p> <p>The filepath to the csv file is <code>../input/wine-reviews/winemag-data_first150k.csv</code>. The first few lines look like:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>,country,description,designation,points,price,province,region_1,region_2,variety,winery
0,US,&quot;This tremendous 100% varietal wine[...]&quot;,Martha's Vineyard,96,235.0,California,Napa Valley,Napa,Cabernet Sauvignon,Heitz
1,Spain,&quot;Ripe aromas of fig, blackberry and[...]&quot;,Carodorum Selección Especial Reserva,96,110.0,Northern Spain,Toro,,Tinta de Toro,Bodega Carmen Rodríguez
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/wine-reviews/winemag-data_first150k.csv'</span><span class="token punctuation">,</span>index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

q4<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
reviews
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_5"><a href="#_5" class="header-anchor">#</a> 5.</h4> <p>Run the cell below to create and display a DataFrame called <code>animals</code>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>animals <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Cows'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Goats'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Year 1'</span><span class="token punctuation">,</span> <span class="token string">'Year 2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
animals
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>In the cell below, write code to save this DataFrame to disk as a csv file with the name <code>cows_and_goats.csv</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code goes here</span>
animals<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'cows_and_goats.csv'</span><span class="token punctuation">)</span>

q5<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_2-indexing-selecting-assigning"><a href="#_2-indexing-selecting-assigning" class="header-anchor">#</a> 2. Indexing, Selecting &amp; Assigning</h2> <h3 id="introduction-3"><a href="#introduction-3" class="header-anchor">#</a> Introduction</h3> <p>Selecting specific values of a pandas DataFrame or Series to work on is an implicit step in almost any data operation you'll run, so one of the first things you need to learn in working with data in Python is how to go about selecting the data points relevant to you quickly and effectively.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;../input/wine-reviews/winemag-data-130k-v2.csv&quot;</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'max_rows'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>To start the exercise for this topic, please click <a href="https://www.kaggle.com/kernels/fork/587910" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</strong></p> <h3 id="naive-accessors"><a href="#naive-accessors" class="header-anchor">#</a> Naive accessors</h3> <p>Native Python objects provide good ways of indexing data. Pandas carries all of these over, which helps make it easy to start with.</p> <p>Consider this DataFrame:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>In Python, we can access the property of an object by accessing it as an attribute. A <code>book</code> object, for example, might have a <code>title</code> property, which we can access by calling <code>book.title</code>. Columns in a pandas DataFrame work in much the same way.</p> <p>Hence to access the <code>country</code> property of <code>reviews</code> we can use:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>country
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>If we have a Python dictionary, we can access its values using the indexing (<code>[]</code>) operator. We can do the same with columns in a DataFrame:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>These are the two ways of selecting a specific Series out of a DataFrame. Neither of them is more or less syntactically valid than the other, but the indexing operator <code>[]</code> does have the advantage that it can handle column names with reserved characters in them (e.g. if we had a <code>country providence</code> column, <code>reviews.country providence</code> wouldn't work).</p> <p>Doesn't a pandas Series look kind of like a fancy dictionary? It pretty much is, so it's no surprise that, to drill down to a single specific value, we need only use the indexing operator <code>[]</code> once more:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="indexing-in-pandas"><a href="#indexing-in-pandas" class="header-anchor">#</a> Indexing in pandas</h3> <p>The indexing operator and attribute selection are nice because they work just like they do in the rest of the Python ecosystem. As a novice, this makes them easy to pick up and use. However, pandas has its own accessor operators, <code>loc</code> and <code>iloc</code>. For more advanced operations, these are the ones you're supposed to be using.</p> <h4 id="index-based-selection"><a href="#index-based-selection" class="header-anchor">#</a> Index-based selection</h4> <p>Pandas indexing works in one of two paradigms. The first is <strong>index-based selection</strong>: selecting data based on its numerical position in the data. <code>iloc</code> follows this paradigm.</p> <p>To select the first row of data in a DataFrame, we may use the following:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Both <code>loc</code> and <code>iloc</code> are row-first, column-second. This is the opposite of what we do in native Python, which is column-first, row-second.</p> <p>This means that it's marginally easier to retrieve rows, and marginally harder to get retrieve columns. To get a column with <code>iloc</code>, we can do the following:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>On its own, the <code>:</code> operator, which also comes from native Python, means &quot;everything&quot;. When combined with other selectors, however, it can be used to indicate a range of values. For example, to select the <code>country</code> column from just the first, second, and third row, we would do:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Or, to select just the second and third entries, we would do:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>It's also possible to pass a list:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Finally, it's worth knowing that negative numbers can be used in selection. This will start counting forwards from the <em>end</em> of the values. So for example here are the last five elements of the dataset.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="label-based-selection"><a href="#label-based-selection" class="header-anchor">#</a> Label-based selection</h4> <p>The second paradigm for attribute selection is the one followed by the <code>loc</code> operator: <strong>label-based selection</strong>. In this paradigm, it's the data index value, not its position, which matters.</p> <p>For example, to get the first entry in <code>reviews</code>, we would now do the following:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'country'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>iloc</code> is conceptually simpler than <code>loc</code> because it ignores the dataset's indices. When we use <code>iloc</code> we treat the dataset like a big matrix (a list of lists), one that we have to index into by position. <code>loc</code>, by contrast, uses the information in the indices to do its work. Since your dataset usually has meaningful indices, it's usually easier to do things using <code>loc</code> instead. For example, here's one operation that's much easier using <code>loc</code>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'taster_name'</span><span class="token punctuation">,</span> <span class="token string">'taster_twitter_handle'</span><span class="token punctuation">,</span> <span class="token string">'points'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="choosing-between-loc-and-iloc"><a href="#choosing-between-loc-and-iloc" class="header-anchor">#</a> Choosing between <code>loc</code> and <code>iloc</code></h4> <p>When choosing or transitioning between <code>loc</code> and <code>iloc</code>, there is one &quot;gotcha&quot; worth keeping in mind, which is that the two methods use slightly different indexing schemes.</p> <p><code>iloc</code> uses the Python stdlib indexing scheme, where the first element of the range is included and the last one excluded. So <code>0:10</code> will select entries <code>0,...,9</code>. <code>loc</code>, meanwhile, indexes inclusively. So <code>0:10</code> will select entries <code>0,...,10</code>.</p> <p>Why the change? Remember that loc can index any stdlib type: strings, for example. If we have a DataFrame with index values <code>Apples, ..., Potatoes, ...</code>, and we want to select &quot;all the alphabetical fruit choices between Apples and Potatoes&quot;, then it's a lot more convenient to index <code>df.loc['Apples':'Potatoes']</code> than it is to index something like <code>df.loc['Apples', 'Potatoet]</code> (<code>t</code> coming after <code>s</code> in the alphabet).</p> <p>This is particularly confusing when the DataFrame index is a simple numerical list, e.g. <code>0,...,1000</code>. In this case <code>df.iloc[0:1000]</code> will return 1000 entries, while <code>df.loc[0:1000]</code> return 1001 of them! To get 1000 elements using <code>loc</code>, you will need to go one lower and ask for <code>df.iloc[0:999]</code>.</p> <p>Otherwise, the semantics of using <code>loc</code> are the same as those for <code>iloc</code>.</p> <h3 id="manipulating-the-index"><a href="#manipulating-the-index" class="header-anchor">#</a> Manipulating the index</h3> <p>Label-based selection derives its power from the labels in the index. Critically, the index we use is not immutable. We can manipulate the index in any way we see fit.</p> <p>The <code>set_index()</code> method can be used to do the job. Here is what happens when we <code>set_index</code> to the <code>title</code> field:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This is useful if you can come up with an index for the dataset which is better than the current one.</p> <h3 id="conditional-selection"><a href="#conditional-selection" class="header-anchor">#</a> Conditional selection</h3> <p>So far we've been indexing various strides of data, using structural properties of the DataFrame itself. To do <em>interesting</em> things with the data, however, we often need to ask questions based on conditions.</p> <p>For example, suppose that we're interested specifically in better-than-average wines produced in Italy.</p> <p>We can start by checking if each wine is Italian or not:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>country <span class="token operator">==</span> <span class="token string">'Italy'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This operation produced a Series of <code>True</code>/<code>False</code> booleans based on the <code>country</code> of each record. This result can then be used inside of <code>loc</code> to select the relevant data:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>reviews<span class="token punctuation">.</span>country <span class="token operator">==</span> <span class="token string">'Italy'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This DataFrame has ~20,000 rows. The original had ~130,000. That means that around 15% of wines originate from Italy.</p> <p>We also wanted to know which ones are better than average. Wines are reviewed on a 80-to-100 point scale, so this could mean wines that accrued at least 90 points.</p> <p>We can use the ampersand (<code>&amp;</code>) to bring the two questions together:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>country <span class="token operator">==</span> <span class="token string">'Italy'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>points <span class="token operator">&gt;=</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Suppose we'll buy any wine that's made in Italy <em>or</em> which is rated above average. For this we use a pipe (<code>|</code>):</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>country <span class="token operator">==</span> <span class="token string">'Italy'</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>points <span class="token operator">&gt;=</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Pandas comes with a few built-in conditional selectors, two of which we will highlight here.</p> <p>The first is <code>isin</code>. <code>isin</code> is lets you select data whose value &quot;is in&quot; a list of values. For example, here's how we can use it to select wines only from Italy or France:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>reviews<span class="token punctuation">.</span>country<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Italy'</span><span class="token punctuation">,</span> <span class="token string">'France'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The second is <code>isnull</code> (and its companion <code>notnull</code>). These methods let you highlight values which are (or are not) empty (<code>NaN</code>). For example, to filter out wines lacking a price tag in the dataset, here's what we would do:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>reviews<span class="token punctuation">.</span>price<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="assigning-data"><a href="#assigning-data" class="header-anchor">#</a> Assigning data</h3> <p>Going the other way, assigning data to a DataFrame is easy. You can assign either a constant value:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">[</span><span class="token string">'critic'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'everyone'</span>
reviews<span class="token punctuation">[</span><span class="token string">'critic'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Or with an iterable of values:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">[</span><span class="token string">'index_backwards'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>reviews<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
reviews<span class="token punctuation">[</span><span class="token string">'index_backwards'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="exercise-indexing-selecting-assigning"><a href="#exercise-indexing-selecting-assigning" class="header-anchor">#</a> Exercise: Indexing, Selecting &amp; Assigning</h3> <p>If you haven't started the exercise, you can <strong><a href="https://www.kaggle.com/kernels/fork/587910" target="_blank" rel="noopener noreferrer">get started here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>.</p> <h4 id="introduction-4"><a href="#introduction-4" class="header-anchor">#</a> Introduction</h4> <p>In this set of exercises we will work with the <a href="https://www.kaggle.com/zynicide/wine-reviews" target="_blank" rel="noopener noreferrer">Wine Reviews dataset<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Run the following cell to load your data and some utility functions (including code to check your answers).</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;../input/wine-reviews/winemag-data-130k-v2.csv&quot;</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&quot;display.max_rows&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>core <span class="token keyword">import</span> binder<span class="token punctuation">;</span> binder<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>pandas<span class="token punctuation">.</span>indexing_selecting_and_assigning <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup complete.&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Look at an overview of your data by running the following line.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_1-2"><a href="#_1-2" class="header-anchor">#</a> 1.</h4> <p>Select the <code>description</code> column from <code>reviews</code> and assign the result to the variable <code>desc</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code here</span>
desc <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">)</span>
q1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Follow-up question: what type of object is <code>desc</code>? If you're not sure, you can check by calling Python's <code>type</code> function: <code>type(desc)</code>.</p> <p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>desc <span class="token operator">=</span> reviews<span class="token punctuation">.</span>description
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>or</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>desc <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&quot;description&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>desc</code> is a pandas <code>Series</code> object, with an index matching the <code>reviews</code> DataFrame. In general, when we select a single column from a DataFrame, we'll get a Series.</p> <h4 id="_2-2"><a href="#_2-2" class="header-anchor">#</a> 2.</h4> <p>Select the first value from the description column of <code>reviews</code>, assigning it to variable <code>first_description</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>first_description <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

q2<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
first_description
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>first_description <span class="token operator">=</span> reviews<span class="token punctuation">.</span>description<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Note that while this is the preferred way to obtain the entry in the DataFrame, many other options will return a valid result, such as <code>reviews.description.loc[0]</code>, <code>reviews.description[0]</code>, and more!</p> <h4 id="_3-2"><a href="#_3-2" class="header-anchor">#</a> 3.</h4> <p>Select the first row of data (the first record) from <code>reviews</code>, assigning it to the variable <code>first_row</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>first_row <span class="token operator">=</span> reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

q3<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
first_row
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_4-2"><a href="#_4-2" class="header-anchor">#</a> 4.</h4> <p>Select the first 10 values from the <code>description</code> column in <code>reviews</code>, assigning the result to variable <code>first_descriptions</code>.</p> <p>Hint: format your output as a pandas Series.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>first_descriptions <span class="token operator">=</span> reviews<span class="token punctuation">.</span>description<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>

q4<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
first_descriptions
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>first_descriptions <span class="token operator">=</span> reviews<span class="token punctuation">.</span>description<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Note that many other options will return a valid result, such as <code>desc.head(10)</code> and <code>reviews.loc[:9, &quot;description&quot;]</code>.</p> <h4 id="_5-2"><a href="#_5-2" class="header-anchor">#</a> 5.</h4> <p>Select the records with index labels <code>1</code>, <code>2</code>, <code>3</code>, <code>5</code>, and <code>8</code>, assigning the result to the variable <code>sample_reviews</code>.</p> <p>In other words, generate the following DataFrame:</p> <p><img src="https://i.imgur.com/sHZvI1O.png" alt=""></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>sample_reviews <span class="token operator">=</span> reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

q5<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
sample_reviews
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>indices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span>
sample_reviews <span class="token operator">=</span> reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>indices<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_6"><a href="#_6" class="header-anchor">#</a> 6.</h4> <p>Create a variable <code>df</code> containing the <code>country</code>, <code>province</code>, <code>region_1</code>, and <code>region_2</code> columns of the records with the index labels <code>0</code>, <code>1</code>, <code>10</code>, and <code>100</code>. In other words, generate the following DataFrame:</p> <p><img src="https://i.imgur.com/FUCGiKP.png" alt=""></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>df <span class="token operator">=</span> reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span><span class="token string">'province'</span><span class="token punctuation">,</span><span class="token string">'region_1'</span><span class="token punctuation">,</span><span class="token string">'region_2'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

q6<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
df
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'province'</span><span class="token punctuation">,</span> <span class="token string">'region_1'</span><span class="token punctuation">,</span> <span class="token string">'region_2'</span><span class="token punctuation">]</span>
indices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span>
df <span class="token operator">=</span> reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>indices<span class="token punctuation">,</span> cols<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_7"><a href="#_7" class="header-anchor">#</a> 7.</h4> <p>Create a variable <code>df</code> containing the <code>country</code> and <code>variety</code> columns of the first 100 records.</p> <p>Hint: you may use <code>loc</code> or <code>iloc</code>. When working on the answer this question and the several of the ones that follow, keep the following &quot;gotcha&quot; described in the tutorial:</p> <blockquote><p><code>iloc</code> uses the Python stdlib indexing scheme, where the first element of the range is included and the last one excluded.
<code>loc</code>, meanwhile, indexes inclusively.</p></blockquote> <blockquote><p>This is particularly confusing when the DataFrame index is a simple numerical list, e.g. <code>0,...,1000</code>. In this case <code>df.iloc[0:1000]</code> will return 1000 entries, while <code>df.loc[0:1000]</code> return 1001 of them! To get 1000 elements using <code>loc</code>, you will need to go one lower and ask for <code>df.iloc[0:999]</code>.</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code>df <span class="token operator">=</span> reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span><span class="token string">'variety'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

q7<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
df
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'variety'</span><span class="token punctuation">]</span>
df <span class="token operator">=</span> reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">99</span><span class="token punctuation">,</span> cols<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>or</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>cols_idx <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span>
df <span class="token operator">=</span> reviews<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span> cols_idx<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_8"><a href="#_8" class="header-anchor">#</a> 8.</h4> <p>Create a DataFrame <code>italian_wines</code> containing reviews of wines made in <code>Italy</code>. Hint: <code>reviews.country</code> equals what?</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>italian_wines <span class="token operator">=</span> reviews<span class="token punctuation">[</span>reviews<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">'Italy'</span><span class="token punctuation">]</span>

q8<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_9"><a href="#_9" class="header-anchor">#</a> 9.</h4> <p>Create a DataFrame <code>top_oceania_wines</code> containing all reviews with at least 95 points (out of 100) for wines from Australia or New Zealand.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>top_oceania_wines <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>country<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Australia'</span><span class="token punctuation">,</span> <span class="token string">'New Zealand'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>points <span class="token operator">&gt;=</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

q9<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
top_oceania_wines
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>top_oceania_wines <span class="token operator">=</span> reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>
    <span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>country<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Australia'</span><span class="token punctuation">,</span> <span class="token string">'New Zealand'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">&amp;</span> <span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>points <span class="token operator">&gt;=</span> <span class="token number">95</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_3-summary-functions-and-maps"><a href="#_3-summary-functions-and-maps" class="header-anchor">#</a> 3. Summary Functions and Maps</h2> <h3 id="introduction-5"><a href="#introduction-5" class="header-anchor">#</a> Introduction</h3> <p>In the last tutorial, we learned how to select relevant data out of a DataFrame or Series. Plucking the right data out of our data representation is critical to getting work done, as we demonstrated in the exercises.</p> <p>However, the data does not always come out of memory in the format we want it in right out of the bat. Sometimes we have to do some more work ourselves to reformat it for the task at hand. This tutorial will cover different operations we can apply to our data to get the input &quot;just right&quot;.</p> <p><strong>To start the exercise for this topic, please click <a href="https://www.kaggle.com/kernels/fork/595524" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</strong></p> <p>We'll use the Wine Magazine data for demonstration.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="summary-functions"><a href="#summary-functions" class="header-anchor">#</a> Summary functions</h3> <p>Pandas provides many simple &quot;summary functions&quot; (not an official name) which restructure the data in some useful way. For example, consider the <code>describe()</code> method:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>points<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This method generates a high-level summary of the attributes of the given column. It is type-aware, meaning that its output changes based on the data type of the input. The output above only makes sense for numerical data; for string data here's what we get:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>taster_name<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>If you want to get some particular simple summary statistic about a column in a DataFrame or a Series, there is usually a helpful pandas function that makes it happen.</p> <p>For example, to see the mean of the points allotted (e.g. how well an averagely rated wine does), we can use the <code>mean()</code> function:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>points<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>To see a list of unique values we can use the <code>unique()</code> function:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>taster_name<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>To see a list of unique values <em>and</em> how often they occur in the dataset, we can use the <code>value_counts()</code> method:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>taster_name<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="maps"><a href="#maps" class="header-anchor">#</a> Maps</h3> <p>A <strong>map</strong> is a term, borrowed from mathematics, for a function that takes one set of values and &quot;maps&quot; them to another set of values. In data science we often have a need for creating new representations from existing data, or for transforming data from the format it is in now to the format that we want it to be in later. Maps are what handle this work, making them extremely important for getting your work done!</p> <p>There are two mapping methods that you will use often.</p> <p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.map.html" target="_blank" rel="noopener noreferrer"><code>map()</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is the first, and slightly simpler one. For example, suppose that we wanted to remean the scores the wines received to 0. We can do this as follows:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>review_points_mean <span class="token operator">=</span> reviews<span class="token punctuation">.</span>points<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
reviews<span class="token punctuation">.</span>points<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> p<span class="token punctuation">:</span> p <span class="token operator">-</span> review_points_mean<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>The function you pass to <code>map()</code> should expect a single value from the Series (a point value, in the above example), and return a transformed version of that value. <code>map()</code> returns a new Series where all the values have been transformed by your function.</p> <p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.apply.html" target="_blank" rel="noopener noreferrer"><code>apply()</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is the equivalent method if we want to transform a whole DataFrame by calling a custom method on each row.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">remean_points</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    row<span class="token punctuation">.</span>points <span class="token operator">=</span> row<span class="token punctuation">.</span>points <span class="token operator">-</span> review_points_mean
    <span class="token keyword">return</span> row

reviews<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>remean_points<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>If we had called <code>reviews.apply()</code> with <code>axis='index'</code>, then instead of passing a function to transform each row, we would need to give a function to transform each <em>column</em>.</p> <p>Note that <code>map()</code> and <code>apply()</code> return new, transformed Series and DataFrames, respectively. They don't modify the original data they're called on. If we look at the first row of <code>reviews</code>, we can see that it still has its original <code>points</code> value.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Pandas provides many common mapping operations as built-ins. For example, here's a faster way of remeaning our points column:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>review_points_mean <span class="token operator">=</span> reviews<span class="token punctuation">.</span>points<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
reviews<span class="token punctuation">.</span>points <span class="token operator">-</span> review_points_mean
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>In this code we are performing an operation between a lot of values on the left-hand side (everything in the Series) and a single value on the right-hand side (the mean value). Pandas looks at this expression and figures out that we must mean to subtract that mean value from every value in the dataset.</p> <p>Pandas will also understand what to do if we perform these operations between Series of equal length. For example, an easy way of combining country and region information in the dataset would be to do the following:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>country <span class="token operator">+</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">+</span> reviews<span class="token punctuation">.</span>region_1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>These operators are faster than <code>map()</code> or <code>apply()</code> because they uses speed ups built into pandas. All of the standard Python operators (<code>&gt;</code>, <code>&lt;</code>, <code>==</code>, and so on) work in this manner.</p> <p>However, they are not as flexible as <code>map()</code> or <code>apply()</code>, which can do more advanced things, like applying conditional logic, which cannot be done with addition and subtraction alone.</p> <h3 id="exercise-summary-functions-and-maps"><a href="#exercise-summary-functions-and-maps" class="header-anchor">#</a> Exercise: Summary Functions and Maps</h3> <p>If you haven't started the exercise, you can <strong><a href="https://www.kaggle.com/kernels/fork/595524" target="_blank" rel="noopener noreferrer">get started here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>.</p> <h4 id="introduction-6"><a href="#introduction-6" class="header-anchor">#</a> Introduction</h4> <p>Now you are ready to get a deeper understanding of your data.</p> <p>Run the following cell to load your data and some utility functions (including code to check your answers).</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&quot;display.max_rows&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;../input/wine-reviews/winemag-data-130k-v2.csv&quot;</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>core <span class="token keyword">import</span> binder<span class="token punctuation">;</span> binder<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>pandas<span class="token punctuation">.</span>summary_functions_and_maps <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup complete.&quot;</span><span class="token punctuation">)</span>

reviews<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_1-3"><a href="#_1-3" class="header-anchor">#</a> 1.</h4> <p>What is the median of the <code>points</code> column in the <code>reviews</code> DataFrame?</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>median_points <span class="token operator">=</span> reviews<span class="token punctuation">.</span>points<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span>

q1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-3"><a href="#_2-3" class="header-anchor">#</a> 2.</h4> <p>What countries are represented in the dataset? (Your answer should not include any duplicates.)</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>countries <span class="token operator">=</span> reviews<span class="token punctuation">.</span>country<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>

q2<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-3"><a href="#_3-3" class="header-anchor">#</a> 3.</h4> <p>How often does each country appear in the dataset? Create a Series <code>reviews_per_country</code> mapping countries to the count of reviews of wines from that country.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews_per_country <span class="token operator">=</span> reviews<span class="token punctuation">.</span>country<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>

q3<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_4-3"><a href="#_4-3" class="header-anchor">#</a> 4.</h4> <p>Create variable <code>centered_price</code> containing a version of the <code>price</code> column with the mean price subtracted.</p> <p>(Note: this 'centering' transformation is a common preprocessing step before applying various machine learning algorithms.)</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>centered_price <span class="token operator">=</span> reviews<span class="token punctuation">.</span>price <span class="token operator">-</span> reviews<span class="token punctuation">.</span>price<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

q4<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_5-3"><a href="#_5-3" class="header-anchor">#</a> 5.</h4> <p>I'm an economical wine buyer. Which wine is the &quot;best bargain&quot;? Create a variable <code>bargain_wine</code> with the title of the wine with the highest points-to-price ratio in the dataset.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>bargain_idx <span class="token operator">=</span> <span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>points <span class="token operator">/</span> reviews<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span>
bargain_wine <span class="token operator">=</span> reviews<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>bargain_idx<span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span>

q5<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_6-2"><a href="#_6-2" class="header-anchor">#</a> 6.</h4> <p>There are only so many words you can use when describing a bottle of wine. Is a wine more likely to be &quot;tropical&quot; or &quot;fruity&quot;? Create a Series <code>descriptor_counts</code> counting how many times each of these two words appears in the <code>description</code> column in the dataset.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>n_trop <span class="token operator">=</span> reviews<span class="token punctuation">.</span>description<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> desc<span class="token punctuation">:</span> <span class="token string">&quot;tropical&quot;</span> <span class="token keyword">in</span> desc<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
n_fruity <span class="token operator">=</span> reviews<span class="token punctuation">.</span>description<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> desc<span class="token punctuation">:</span> <span class="token string">&quot;fruity&quot;</span> <span class="token keyword">in</span> desc<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
descriptor_counts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span>n_trop<span class="token punctuation">,</span> n_fruity<span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'tropical'</span><span class="token punctuation">,</span> <span class="token string">'fruity'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

q6<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_7-2"><a href="#_7-2" class="header-anchor">#</a> 7.</h4> <p>We'd like to host these wine reviews on our website, but a rating system ranging from 80 to 100 points is too hard to understand - we'd like to translate them into simple star ratings. A score of 95 or higher counts as 3 stars, a score of at least 85 but less than 95 is 2 stars. Any other score is 1 star.</p> <p>Also, the Canadian Vintners Association bought a lot of ads on the site, so any wines from Canada should automatically get 3 stars, regardless of points.</p> <p>Create a series <code>star_ratings</code> with the number of stars corresponding to each review in the dataset.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">stars</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> row<span class="token punctuation">.</span>country <span class="token operator">==</span> <span class="token string">'Canada'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">3</span>
    <span class="token keyword">elif</span> row<span class="token punctuation">.</span>points <span class="token operator">&gt;=</span> <span class="token number">95</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">3</span>
    <span class="token keyword">elif</span> row<span class="token punctuation">.</span>points <span class="token operator">&gt;=</span> <span class="token number">85</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">2</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span>

star_ratings <span class="token operator">=</span> reviews<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>stars<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">)</span>

q7<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_4-grouping-and-sorting"><a href="#_4-grouping-and-sorting" class="header-anchor">#</a> 4. Grouping and Sorting</h2> <h3 id="introduction-7"><a href="#introduction-7" class="header-anchor">#</a> Introduction</h3> <p>Maps allow us to transform data in a DataFrame or Series one value at a time for an entire column. However, often we want to group our data, and then do something specific to the group the data is in.</p> <p>As you'll learn, we do this with the <code>groupby()</code> operation. We'll also cover some additional topics, such as more complex ways to index your DataFrames, along with how to sort your data.</p> <p><strong>To start the exercise for this topic, please click <a href="https://www.kaggle.com/kernels/fork/598715" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</strong></p> <h3 id="groupwise-analysis"><a href="#groupwise-analysis" class="header-anchor">#</a> Groupwise analysis</h3> <p>One function we've been using heavily thus far is the <code>value_counts()</code> function. We can replicate what <code>value_counts()</code> does by doing the following:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'points'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>groupby()</code> created a group of reviews which allotted the same point values to the given wines. Then, for each of these groups, we grabbed the <code>points()</code> column and counted how many times it appeared. <code>value_counts()</code> is just a shortcut to this <code>groupby()</code> operation.</p> <p>We can use any of the summary functions we've used before with this data. For example, to get the cheapest wine in each point value category, we can do the following:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'points'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>price<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>You can think of each group we generate as being a slice of our DataFrame containing only data with values that match. This DataFrame is accessible to us directly using the <code>apply()</code> method, and we can then manipulate the data in any way we see fit. For example, here's one way of selecting the name of the first wine reviewed from each winery in the dataset:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'winery'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">.</span>title<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>For even more fine-grained control, you can also group by more than one column. For an example, here's how we would pick out the best wine by country <em>and</em> province:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'province'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>points<span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Another <code>groupby()</code> method worth mentioning is <code>agg()</code>, which lets you run a bunch of different functions on your DataFrame simultaneously. For example, we can generate a simple statistical summary of the dataset as follows:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>price<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Effective use of <code>groupby()</code> will allow you to do lots of really powerful things with your dataset.</p> <h3 id="multi-indexes"><a href="#multi-indexes" class="header-anchor">#</a> Multi-indexes</h3> <p>In all of the examples we've seen thus far we've been working with DataFrame or Series objects with a single-label index. <code>groupby()</code> is slightly different in the fact that, depending on the operation we run, it will sometimes result in what is called a multi-index.</p> <p>A multi-index differs from a regular index in that it has multiple levels. For example:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>countries_reviewed <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'province'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>description<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
countries_reviewed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>mi <span class="token operator">=</span> countries_reviewed<span class="token punctuation">.</span>index
<span class="token builtin">type</span><span class="token punctuation">(</span>mi<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Multi-indices have several methods for dealing with their tiered structure which are absent for single-level indices. They also require two levels of labels to retrieve a value. Dealing with multi-index output is a common &quot;gotcha&quot; for users new to pandas.</p> <p>The use cases for a multi-index are detailed alongside instructions on using them in the <a href="https://pandas.pydata.org/pandas-docs/stable/advanced.html" target="_blank" rel="noopener noreferrer">MultiIndex / Advanced Selection<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> section of the pandas documentation.</p> <p>However, in general the multi-index method you will use most often is the one for converting back to a regular index, the <code>reset_index()</code> method:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>countries_reviewed<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="sorting"><a href="#sorting" class="header-anchor">#</a> Sorting</h3> <p>Looking again at <code>countries_reviewed</code> we can see that grouping returns data in index order, not in value order. That is to say, when outputting the result of a <code>groupby</code>, the order of the rows is dependent on the values in the index, not in the data.</p> <p>To get data in the order want it in we can sort it ourselves. The <code>sort_values()</code> method is handy for this.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>countries_reviewed <span class="token operator">=</span> countries_reviewed<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
countries_reviewed<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'len'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>sort_values()</code> defaults to an ascending sort, where the lowest values go first. However, most of the time we want a descending sort, where the higher numbers go first. That goes thusly:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>countries_reviewed<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'len'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>To sort by index values, use the companion method <code>sort_index()</code>. This method has the same arguments and default order:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>countries_reviewed<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Finally, know that you can sort by more than one column at a time:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>countries_reviewed<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'len'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="exercise-grouping-and-sorting"><a href="#exercise-grouping-and-sorting" class="header-anchor">#</a> Exercise: Grouping and Sorting</h3> <h4 id="introduction-8"><a href="#introduction-8" class="header-anchor">#</a> Introduction</h4> <p>In these exercises we'll apply groupwise analysis to our dataset.</p> <p>Run the code cell below to load the data before running the exercises.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;../input/wine-reviews/winemag-data-130k-v2.csv&quot;</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">#pd.set_option(&quot;display.max_rows&quot;, 5)</span>

<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>core <span class="token keyword">import</span> binder<span class="token punctuation">;</span> binder<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>pandas<span class="token punctuation">.</span>grouping_and_sorting <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup complete.&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_1-4"><a href="#_1-4" class="header-anchor">#</a> 1.</h4> <p>Who are the most common wine reviewers in the dataset? Create a <code>Series</code> whose index is the <code>taster_twitter_handle</code> category from the dataset, and whose values count how many reviews each person wrote.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code here</span>
reviews_written <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'taster_twitter_handle'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>

q1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews_written <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'taster_twitter_handle'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>or</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviews_written <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'taster_twitter_handle'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>taster_twitter_handle<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-4"><a href="#_2-4" class="header-anchor">#</a> 2.</h4> <p>What is the best wine I can buy for a given amount of money? Create a <code>Series</code> whose index is wine prices and whose values is the maximum number of points a wine costing that much was given in a review. Sort the values by price, ascending (so that <code>4.0</code> dollars is at the top and <code>3300.0</code> dollars is at the bottom).</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>best_rating_per_price <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'price'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span>

q2<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-4"><a href="#_3-4" class="header-anchor">#</a> 3.</h4> <p>What are the minimum and maximum prices for each <code>variety</code> of wine? Create a <code>DataFrame</code> whose index is the <code>variety</code> category from the dataset and whose values are the <code>min</code> and <code>max</code> values thereof.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>price_extremes <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'variety'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>price<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">min</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

q3<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_4-4"><a href="#_4-4" class="header-anchor">#</a> 4.</h4> <p>What are the most expensive wine varieties? Create a variable <code>sorted_varieties</code> containing a copy of the dataframe from the previous question where varieties are sorted in descending order based on minimum price, then on maximum price (to break ties).</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>sorted_varieties <span class="token operator">=</span> price_extremes<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'min'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

q4<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_5-4"><a href="#_5-4" class="header-anchor">#</a> 5.</h4> <p>Create a <code>Series</code> whose index is reviewers and whose values is the average review score given out by that reviewer. Hint: you will need the <code>taster_name</code> and <code>points</code> columns.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviewer_mean_ratings <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'taster_name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

q5<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Are there significant differences in the average scores assigned by the various reviewers? Run the cell below to use the <code>describe()</code> method to see a summary of the range of values.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>reviewer_mean_ratings<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_6-3"><a href="#_6-3" class="header-anchor">#</a> 6.</h4> <p>What combination of countries and varieties are most common? Create a <code>Series</code> whose index is a <code>MultiIndex</code>of <code>{country, variety}</code> pairs. For example, a pinot noir produced in the US should map to <code>{&quot;US&quot;, &quot;Pinot Noir&quot;}</code>. Sort the values in the <code>Series</code> in descending order based on wine count.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>country_variety_counts <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'variety'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

q6<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/evansyangs/Blog-source-code/edit/vuepress-vdoing/docs/_posts/随笔/Kaggle Pandas.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/02/16, 12:50:44</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list no-article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/98bc36/"><div>
            Dell7472黑苹果
            <!----></div></a> <span class="date">03-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/4ca485/"><div>
            上手HackMD
            <!----></div></a> <span class="date">04-13</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/5ce1a4/"><div>
            Windows Terminal设置
            <!----></div></a> <span class="date">03-14</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:isevansyangs@outlook.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/evansyangs" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=634517784" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>Evan Yang</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.f773b411.js" defer></script><script src="/assets/js/2.84387116.js" defer></script><script src="/assets/js/71.9a6c33eb.js" defer></script>
  </body>
</html>
