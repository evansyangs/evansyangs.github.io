<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kaggle Deep Learning Micro-Course | evansyangs</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css">
    <meta name="description" content="Southeast University | Mathematics | Complex Network">
    <meta name="robots" content="all">
    <meta name="author" content="Evan Yang">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="keywords" content="evansyangs,Evan Yang,东南大学,数学学院,复杂网络,博客,blog,Python,深度学习,graph">
    <meta name="theme-color" content="#11a8cd">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no,maximum-scale=1.0,minimum-scale=1.0">
    
    <link rel="preload" href="/assets/css/0.styles.16d34b40.css" as="style"><link rel="preload" href="/assets/js/app.f773b411.js" as="script"><link rel="preload" href="/assets/js/2.84387116.js" as="script"><link rel="preload" href="/assets/js/70.d3fa8b6d.js" as="script"><link rel="prefetch" href="/assets/js/10.44d7445a.js"><link rel="prefetch" href="/assets/js/100.b7dd7617.js"><link rel="prefetch" href="/assets/js/101.fa74c789.js"><link rel="prefetch" href="/assets/js/102.78ccbf5b.js"><link rel="prefetch" href="/assets/js/103.4d3649de.js"><link rel="prefetch" href="/assets/js/104.1c73a116.js"><link rel="prefetch" href="/assets/js/105.2adbc65a.js"><link rel="prefetch" href="/assets/js/106.9d243c83.js"><link rel="prefetch" href="/assets/js/107.55fcdd1e.js"><link rel="prefetch" href="/assets/js/108.acf197ba.js"><link rel="prefetch" href="/assets/js/109.a2d9b242.js"><link rel="prefetch" href="/assets/js/11.a5845681.js"><link rel="prefetch" href="/assets/js/110.085d62dc.js"><link rel="prefetch" href="/assets/js/111.f7fa5986.js"><link rel="prefetch" href="/assets/js/112.b9f8f8fa.js"><link rel="prefetch" href="/assets/js/113.6f22c939.js"><link rel="prefetch" href="/assets/js/114.a0336642.js"><link rel="prefetch" href="/assets/js/115.b4f255c1.js"><link rel="prefetch" href="/assets/js/116.31cac6af.js"><link rel="prefetch" href="/assets/js/12.66434846.js"><link rel="prefetch" href="/assets/js/13.3a28537f.js"><link rel="prefetch" href="/assets/js/14.88f8b393.js"><link rel="prefetch" href="/assets/js/15.5426e551.js"><link rel="prefetch" href="/assets/js/16.51a2b860.js"><link rel="prefetch" href="/assets/js/17.58641bea.js"><link rel="prefetch" href="/assets/js/18.623fdd79.js"><link rel="prefetch" href="/assets/js/19.79d27e55.js"><link rel="prefetch" href="/assets/js/20.7e3e5a46.js"><link rel="prefetch" href="/assets/js/21.27b57aab.js"><link rel="prefetch" href="/assets/js/22.137875fc.js"><link rel="prefetch" href="/assets/js/23.265f7613.js"><link rel="prefetch" href="/assets/js/24.af98e2d4.js"><link rel="prefetch" href="/assets/js/25.58f18516.js"><link rel="prefetch" href="/assets/js/26.7dc82795.js"><link rel="prefetch" href="/assets/js/27.e83d9a94.js"><link rel="prefetch" href="/assets/js/28.7280b933.js"><link rel="prefetch" href="/assets/js/29.a6de8923.js"><link rel="prefetch" href="/assets/js/3.5bbbaab9.js"><link rel="prefetch" href="/assets/js/30.12280610.js"><link rel="prefetch" href="/assets/js/31.b401bce2.js"><link rel="prefetch" href="/assets/js/32.a41aa550.js"><link rel="prefetch" href="/assets/js/33.74f77079.js"><link rel="prefetch" href="/assets/js/34.f6bee898.js"><link rel="prefetch" href="/assets/js/35.8ab1d6c8.js"><link rel="prefetch" href="/assets/js/36.82ffd70d.js"><link rel="prefetch" href="/assets/js/37.4ed1a841.js"><link rel="prefetch" href="/assets/js/38.be34326e.js"><link rel="prefetch" href="/assets/js/39.36cac3b5.js"><link rel="prefetch" href="/assets/js/4.1a57c6b1.js"><link rel="prefetch" href="/assets/js/40.117eafb3.js"><link rel="prefetch" href="/assets/js/41.f92660a5.js"><link rel="prefetch" href="/assets/js/42.92ca6c1a.js"><link rel="prefetch" href="/assets/js/43.24d6c834.js"><link rel="prefetch" href="/assets/js/44.459a7f4d.js"><link rel="prefetch" href="/assets/js/45.bf753765.js"><link rel="prefetch" href="/assets/js/46.73396ac5.js"><link rel="prefetch" href="/assets/js/47.fdc5d000.js"><link rel="prefetch" href="/assets/js/48.ddbc6653.js"><link rel="prefetch" href="/assets/js/49.d5424c41.js"><link rel="prefetch" href="/assets/js/5.e1170737.js"><link rel="prefetch" href="/assets/js/50.f46c6124.js"><link rel="prefetch" href="/assets/js/51.e875daef.js"><link rel="prefetch" href="/assets/js/52.8b953c20.js"><link rel="prefetch" href="/assets/js/53.5c6f94ef.js"><link rel="prefetch" href="/assets/js/54.5317fba4.js"><link rel="prefetch" href="/assets/js/55.6522561d.js"><link rel="prefetch" href="/assets/js/56.98bed07c.js"><link rel="prefetch" href="/assets/js/57.e778c254.js"><link rel="prefetch" href="/assets/js/58.e34afd97.js"><link rel="prefetch" href="/assets/js/59.732d9aab.js"><link rel="prefetch" href="/assets/js/6.f4073d0d.js"><link rel="prefetch" href="/assets/js/60.d8b1a318.js"><link rel="prefetch" href="/assets/js/61.8a6a8451.js"><link rel="prefetch" href="/assets/js/62.3d3fe79e.js"><link rel="prefetch" href="/assets/js/63.234f8e91.js"><link rel="prefetch" href="/assets/js/64.1b5a8e0c.js"><link rel="prefetch" href="/assets/js/65.7a54d2d7.js"><link rel="prefetch" href="/assets/js/66.d97afc69.js"><link rel="prefetch" href="/assets/js/67.15e81787.js"><link rel="prefetch" href="/assets/js/68.8d6268c4.js"><link rel="prefetch" href="/assets/js/69.e03bdfb1.js"><link rel="prefetch" href="/assets/js/7.8bb46d41.js"><link rel="prefetch" href="/assets/js/71.9a6c33eb.js"><link rel="prefetch" href="/assets/js/72.f479a007.js"><link rel="prefetch" href="/assets/js/73.05f6d222.js"><link rel="prefetch" href="/assets/js/74.f8265d95.js"><link rel="prefetch" href="/assets/js/75.fb326784.js"><link rel="prefetch" href="/assets/js/76.f4ac48c3.js"><link rel="prefetch" href="/assets/js/77.55a98b8d.js"><link rel="prefetch" href="/assets/js/78.398dd83a.js"><link rel="prefetch" href="/assets/js/79.2919014c.js"><link rel="prefetch" href="/assets/js/8.4a08d6dc.js"><link rel="prefetch" href="/assets/js/80.eacf4199.js"><link rel="prefetch" href="/assets/js/81.f0cc5ad8.js"><link rel="prefetch" href="/assets/js/82.c356758e.js"><link rel="prefetch" href="/assets/js/83.b18db0eb.js"><link rel="prefetch" href="/assets/js/84.cb4f79ea.js"><link rel="prefetch" href="/assets/js/85.e2199493.js"><link rel="prefetch" href="/assets/js/86.dac97b7b.js"><link rel="prefetch" href="/assets/js/87.83c0fa97.js"><link rel="prefetch" href="/assets/js/88.979ba04e.js"><link rel="prefetch" href="/assets/js/89.fbbb74bd.js"><link rel="prefetch" href="/assets/js/9.cd565d1d.js"><link rel="prefetch" href="/assets/js/90.3dd3f7a7.js"><link rel="prefetch" href="/assets/js/91.a510d946.js"><link rel="prefetch" href="/assets/js/92.1e0f20ff.js"><link rel="prefetch" href="/assets/js/93.75a05811.js"><link rel="prefetch" href="/assets/js/94.b3c43bf3.js"><link rel="prefetch" href="/assets/js/95.44ce33cf.js"><link rel="prefetch" href="/assets/js/96.b560aa1e.js"><link rel="prefetch" href="/assets/js/97.6c8f2792.js"><link rel="prefetch" href="/assets/js/98.973fb36c.js"><link rel="prefetch" href="/assets/js/99.18da096b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.16d34b40.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="evansyangs" class="logo"> <span class="site-name can-hide">evansyangs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/evansyangs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://i.loli.net/2020/07/04/QPk6fSMGw4hcz3n.jpg"> <div class="blogger-info"><h3>Evan Yang</h3> <span>摸鱼小能手</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/evansyangs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Kaggle Deep Learning Micro-Course</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/e4f974/#_1-intro-to-dl-for-computer-vision" class="sidebar-link">1. Intro to DL for Computer Vision</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#intro" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#lesson" class="sidebar-link">Lesson</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#exercise-intro-to-dl-for-computer-vision" class="sidebar-link">Exercise: Intro to DL for Computer Vision</a></li></ul></li><li><a href="/pages/e4f974/#_2-building-models-from-convolutions" class="sidebar-link">2. Building Models From Convolutions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#intro-3" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#lesson-2" class="sidebar-link">Lesson</a></li></ul></li><li><a href="/pages/e4f974/#_3-tensorflow-programming" class="sidebar-link">3. TensorFlow Programming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#intro-4" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#lesson-3" class="sidebar-link">Lesson</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#sample-code" class="sidebar-link">Sample Code</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#exercise-tensorflow-programming" class="sidebar-link">Exercise: TensorFlow Programming</a></li></ul></li><li><a href="/pages/e4f974/#_4-transfer-learning" class="sidebar-link">4. Transfer Learning</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#intro-6" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#lesson-4" class="sidebar-link">Lesson</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#sample-code-2" class="sidebar-link">Sample Code</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#exercise-transfer-learning" class="sidebar-link">Exercise: Transfer Learning</a></li></ul></li><li><a href="/pages/e4f974/#_5-data-augmentation" class="sidebar-link">5. Data Augmentation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#intro-7" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#lesson-5" class="sidebar-link">Lesson</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#sample-code-3" class="sidebar-link">Sample Code</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#exercise-data-augmentation" class="sidebar-link">Exercise: Data Augmentation</a></li></ul></li><li><a href="/pages/e4f974/#_6-a-deeper-understanding-of-deep-learning" class="sidebar-link">6. A Deeper Understanding of Deep Learning</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#intro-8" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#lesson-6" class="sidebar-link">Lesson</a></li></ul></li><li><a href="/pages/e4f974/#_7-deep-learning-from-scratch" class="sidebar-link">7. Deep Learning From Scratch</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#intro-9" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#lesson-7" class="sidebar-link">Lesson</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#sample-code-4" class="sidebar-link">Sample Code</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#exercise-deep-learning-from-scratch" class="sidebar-link">Exercise: Deep Learning From Scratch</a></li></ul></li><li><a href="/pages/e4f974/#_8-dropout-and-strides-for-larger-models" class="sidebar-link">8. Dropout and Strides for Larger Models</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#intro-10" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#lesson-8" class="sidebar-link">Lesson</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#sample-code-5" class="sidebar-link">Sample Code</a></li><li class="sidebar-sub-header level3"><a href="/pages/e4f974/#exercise-dropout-and-strides-for-larger-models" class="sidebar-link">Exercise: Dropout and Strides for Larger Models</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="placeholder"></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Kaggle Deep Learning Micro-Course<!----></h1> <!----> <div class="theme-vdoing-content content__default"><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>Use TensorFlow to take Machine Learning to the next level. Your new skills will amaze you.</p></div> <h2 id="_1-intro-to-dl-for-computer-vision"><a href="#_1-intro-to-dl-for-computer-vision" class="header-anchor">#</a> 1. Intro to DL for Computer Vision</h2> <h3 id="intro"><a href="#intro" class="header-anchor">#</a> Intro</h3> <p>After the end of this lesson, you will understand convolutions. Convolutions are the basic building block for deep learning models in computer vision (and many other applications).</p> <p>After that, we'll quickly progress to using world-class deep learning models.</p> <h3 id="lesson"><a href="#lesson" class="header-anchor">#</a> Lesson</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> YouTubeVideo

YouTubeVideo<span class="token punctuation">(</span><span class="token string">'wG6rdUURU-w'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;iframe width=100% height=320 src=&quot;https://www.youtube.com/embed/wG6rdUURU-w?start=2&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="exercise-intro-to-dl-for-computer-vision"><a href="#exercise-intro-to-dl-for-computer-vision" class="header-anchor">#</a> Exercise: Intro to DL for Computer Vision</h3> <p>After the video, <strong><a href="https://www.kaggle.com/kernels/fork/499266" target="_blank" rel="noopener noreferrer">test your understanding of convolutions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <h4 id="intro-2"><a href="#intro-2" class="header-anchor">#</a> Intro</h4> <p>You don't directly choose the numbers to go into your convolutions for deep learning... instead the deep learning technique determines what convolutions will be useful from the data (as part of model-training). We'll come back to how the model does that soon.</p> <center><img src="https://i.imgur.com/op9Maqr.png" width="60%" height="40%" alt="convolutions"></center> <p>But looking closely at convolutions and how they are applied to your image will improve your intuition for these models, how they work, and how to debug them when they don't work.</p> <h4 id="exercise-1"><a href="#exercise-1" class="header-anchor">#</a> Exercise 1</h4> <p>In the video, you saw a convolution that detected horizontal lines. That convolution shows up again in the code cell below.</p> <p>Run the cell to see a raw image as well as the output from applying this convolution to the image.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>horizontal_line_conv <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment"># load_my_image and visualize_conv are utility functions provided for this exercise</span>
original_image <span class="token operator">=</span> load_my_image<span class="token punctuation">(</span><span class="token punctuation">)</span> 
visualize_conv<span class="token punctuation">(</span>original_image<span class="token punctuation">,</span> horizontal_line_conv<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Now it's your turn. Instead of a horizontal line detector, you will create a vertical line detector.</p> <p><strong>Replace the underscores with numbers to make a vertical line detector and uncomment both lines of code in the cell below. Then run</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>vertical_line_conv <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                      <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

q_1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
visualize_conv<span class="token punctuation">(</span>original_image<span class="token punctuation">,</span> vertical_line_conv<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="exercise-2"><a href="#exercise-2" class="header-anchor">#</a> Exercise 2</h4> <p>The convolutions you've seen are 2x2.  But you could have larger convolutions. They could be 3x3, 4x4, etc.  They don't even have to be square. Nothing prevents using a 4x7 convolution.</p> <p>Compare the number of visual patterns that can be captured by small convolutions. Which of the following is true?</p> <ul><li>There are more visual patterns that can be captured by large convolutions</li> <li>There are fewer visual patterns that can be captured by large convolutions</li> <li>The number of visual patterns that can be captured by large convolutions is the same as the number of visual patterns that can be captured by small convolutions?</li></ul> <p>Once you think you know the answer, check it by uncommenting and running the line below.</p> <p><strong>Solution</strong>: While any one convolution measures only a single pattern, there are more possible convolutions that can be created with large sizes. So there are also more patterns that can be captured with large convolutions.</p> <p>For example, it's possible to create a 3x3 convolution that filters for bright pixels with a dark one in the middle. There is no configuration of a 2x2 convolution that would capture this.</p> <p>On the other hand, anything that can be captured by a 2x2 convolution could also be captured by a 3x3 convolution.</p> <p>Does this mean powerful models require extremely large convolutions? Not necessarily. In the next lesson, you will see how deep learning models put together many convolutions to capture complex patterns... including patterns to complex to be captured by any single convolution.</p> <h2 id="_2-building-models-from-convolutions"><a href="#_2-building-models-from-convolutions" class="header-anchor">#</a> 2. Building Models From Convolutions</h2> <h3 id="intro-3"><a href="#intro-3" class="header-anchor">#</a> Intro</h3> <p>By the end of this lesson, you will understand how convolutions are combined to enable superhuman achievements in computer vision.</p> <h3 id="lesson-2"><a href="#lesson-2" class="header-anchor">#</a> Lesson</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> YouTubeVideo
YouTubeVideo<span class="token punctuation">(</span><span class="token string">'ToBPiUlLFEY'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;iframe width=100% height=320 src=&quot;https://www.youtube.com/embed/ToBPiUlLFEY&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Now that you understand the structure of the models, <strong><a href="https://www.kaggle.com/dansbecker/programming-in-tensorflow-and-keras" target="_blank" rel="noopener noreferrer">learn how to build them<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> with TensorFlow and Keras.</p> <h2 id="_3-tensorflow-programming"><a href="#_3-tensorflow-programming" class="header-anchor">#</a> 3. TensorFlow Programming</h2> <h3 id="intro-4"><a href="#intro-4" class="header-anchor">#</a> Intro</h3> <p>At the end of this lesson, you will be able to write TensorFlow and Keras code to use one of the best models in computer vision.</p> <h3 id="lesson-3"><a href="#lesson-3" class="header-anchor">#</a> Lesson</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> YouTubeVideo
YouTubeVideo<span class="token punctuation">(</span><span class="token string">'sDG5tPtsbSA'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;iframe width=100% height=320 src=&quot;https://www.youtube.com/embed/sDG5tPtsbSA&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="sample-code"><a href="#sample-code" class="header-anchor">#</a> Sample Code</h3> <h4 id="choose-images-to-work-with"><a href="#choose-images-to-work-with" class="header-anchor">#</a> Choose Images to Work With</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> join

image_dir <span class="token operator">=</span> <span class="token string">'../input/dog-breed-identification/train/'</span>
img_paths <span class="token operator">=</span> <span class="token punctuation">[</span>join<span class="token punctuation">(</span>image_dir<span class="token punctuation">,</span> filename<span class="token punctuation">)</span> <span class="token keyword">for</span> filename <span class="token keyword">in</span> 
                           <span class="token punctuation">[</span><span class="token string">'0246f44bb123ce3f91c939861eb97fb7.jpg'</span><span class="token punctuation">,</span>
                            <span class="token string">'84728e78632c0910a69d33f82e62638c.jpg'</span><span class="token punctuation">,</span>
                            <span class="token string">'8825e914555803f4c67b26593c9d5aff.jpg'</span><span class="token punctuation">,</span>
                            <span class="token string">'91a5e8db15bccfb6cfa2df5e8b95ec03.jpg'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="function-to-read-and-prep-images-for-modeling"><a href="#function-to-read-and-prep-images-for-modeling" class="header-anchor">#</a> Function to Read and Prep Images for Modeling</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> preprocess_input
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> load_img<span class="token punctuation">,</span> img_to_array

image_size <span class="token operator">=</span> <span class="token number">224</span>

<span class="token keyword">def</span> <span class="token function">read_and_prep_images</span><span class="token punctuation">(</span>img_paths<span class="token punctuation">,</span> img_height<span class="token operator">=</span>image_size<span class="token punctuation">,</span> img_width<span class="token operator">=</span>image_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    imgs <span class="token operator">=</span> <span class="token punctuation">[</span>load_img<span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span>img_height<span class="token punctuation">,</span> img_width<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> img_path <span class="token keyword">in</span> img_paths<span class="token punctuation">]</span>
    img_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>img_to_array<span class="token punctuation">(</span>img<span class="token punctuation">)</span> <span class="token keyword">for</span> img <span class="token keyword">in</span> imgs<span class="token punctuation">]</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> preprocess_input<span class="token punctuation">(</span>img_array<span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="create-model-with-pre-trained-weights-file-make-predictions"><a href="#create-model-with-pre-trained-weights-file-make-predictions" class="header-anchor">#</a> Create Model with Pre-Trained Weights File. Make Predictions</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications <span class="token keyword">import</span> ResNet50

my_model <span class="token operator">=</span> ResNet50<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels.h5'</span><span class="token punctuation">)</span>
test_data <span class="token operator">=</span> read_and_prep_images<span class="token punctuation">(</span>img_paths<span class="token punctuation">)</span>
preds <span class="token operator">=</span> my_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="visualize-predictions"><a href="#visualize-predictions" class="header-anchor">#</a> Visualize Predictions</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> learntools<span class="token punctuation">.</span>deep_learning<span class="token punctuation">.</span>decode_predictions <span class="token keyword">import</span> decode_predictions
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Image<span class="token punctuation">,</span> display

most_likely_labels <span class="token operator">=</span> decode_predictions<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> class_list_path<span class="token operator">=</span><span class="token string">'../input/resnet50/imagenet_class_index.json'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> img_path <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>img_paths<span class="token punctuation">)</span><span class="token punctuation">:</span>
    display<span class="token punctuation">(</span>Image<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>most_likely_labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="exercise-tensorflow-programming"><a href="#exercise-tensorflow-programming" class="header-anchor">#</a> Exercise: TensorFlow Programming</h3> <p>Now you are ready to <strong><a href="https://www.kaggle.com/kernels/fork/521452" target="_blank" rel="noopener noreferrer">use a powerful TensorFlow model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> yourself.</p> <h4 id="intro-5"><a href="#intro-5" class="header-anchor">#</a> Intro</h4> <p>The TV show <em>Silicon Valley</em> had an app called &quot;See Food&quot; that promised to identify food.</p> <p>In this notebook, you will write code using and comparing pre-trained models to choose one as an engine for the See Food app.</p> <p>You won't go too deep into Keras or TensorFlow details in this particular exercise.  Don't worry. You'll go deeper into model development soon.  For now, you'll make sure you know how to use pre-trained models.</p> <h4 id="set-up"><a href="#set-up" class="header-anchor">#</a> Set-Up</h4> <p>We will run a few steps of environmental set-up before writing your own code. <strong>You don't need to understand the details of this set-up code.</strong> You can just run each code cell until you get to the exercises.</p> <h5 id="_1-create-image-paths"><a href="#_1-create-image-paths" class="header-anchor">#</a> 1) Create Image Paths</h5> <p>This workspace includes image files you will use to test your models. Run the cell below to store a few filepaths to these images in a variable <code>img_paths</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> os
<span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> join


hot_dog_image_dir <span class="token operator">=</span> <span class="token string">'../input/hot-dog-not-hot-dog/seefood/train/hot_dog'</span>

hot_dog_paths <span class="token operator">=</span> <span class="token punctuation">[</span>join<span class="token punctuation">(</span>hot_dog_image_dir<span class="token punctuation">,</span>filename<span class="token punctuation">)</span> <span class="token keyword">for</span> filename <span class="token keyword">in</span> 
                            <span class="token punctuation">[</span><span class="token string">'1000288.jpg'</span><span class="token punctuation">,</span>
                             <span class="token string">'127117.jpg'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

not_hot_dog_image_dir <span class="token operator">=</span> <span class="token string">'../input/hot-dog-not-hot-dog/seefood/train/not_hot_dog'</span>
not_hot_dog_paths <span class="token operator">=</span> <span class="token punctuation">[</span>join<span class="token punctuation">(</span>not_hot_dog_image_dir<span class="token punctuation">,</span> filename<span class="token punctuation">)</span> <span class="token keyword">for</span> filename <span class="token keyword">in</span>
                            <span class="token punctuation">[</span><span class="token string">'823536.jpg'</span><span class="token punctuation">,</span>
                             <span class="token string">'99890.jpg'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

img_paths <span class="token operator">=</span> hot_dog_paths <span class="token operator">+</span> not_hot_dog_paths
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h5 id="_2-run-an-example-model"><a href="#_2-run-an-example-model" class="header-anchor">#</a> 2) Run an Example Model</h5> <p>Here is the code you saw in the tutorial. It loads data, loads a pre-trained model, and makes predictions. Run this cell too.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Image<span class="token punctuation">,</span> display
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>deep_learning<span class="token punctuation">.</span>decode_predictions <span class="token keyword">import</span> decode_predictions
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> preprocess_input
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications <span class="token keyword">import</span> ResNet50
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> load_img<span class="token punctuation">,</span> img_to_array


image_size <span class="token operator">=</span> <span class="token number">224</span>

<span class="token keyword">def</span> <span class="token function">read_and_prep_images</span><span class="token punctuation">(</span>img_paths<span class="token punctuation">,</span> img_height<span class="token operator">=</span>image_size<span class="token punctuation">,</span> img_width<span class="token operator">=</span>image_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    imgs <span class="token operator">=</span> <span class="token punctuation">[</span>load_img<span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span>img_height<span class="token punctuation">,</span> img_width<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> img_path <span class="token keyword">in</span> img_paths<span class="token punctuation">]</span>
    img_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>img_to_array<span class="token punctuation">(</span>img<span class="token punctuation">)</span> <span class="token keyword">for</span> img <span class="token keyword">in</span> imgs<span class="token punctuation">]</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> preprocess_input<span class="token punctuation">(</span>img_array<span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>


my_model <span class="token operator">=</span> ResNet50<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels.h5'</span><span class="token punctuation">)</span>
test_data <span class="token operator">=</span> read_and_prep_images<span class="token punctuation">(</span>img_paths<span class="token punctuation">)</span>
preds <span class="token operator">=</span> my_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span>

most_likely_labels <span class="token operator">=</span> decode_predictions<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h5 id="_3-visualize-predictions"><a href="#_3-visualize-predictions" class="header-anchor">#</a> 3) Visualize Predictions</h5> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">for</span> i<span class="token punctuation">,</span> img_path <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>img_paths<span class="token punctuation">)</span><span class="token punctuation">:</span>
    display<span class="token punctuation">(</span>Image<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>most_likely_labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>You will write a couple useful functions in the next exercises. Then you will put these functions together to compare the effectiveness of various pretrained models for your hot-dog detection program.</p> <h4 id="exercise-1-2"><a href="#exercise-1-2" class="header-anchor">#</a> Exercise 1</h4> <p>We want to distinguish whether an image is a hot dog or not. But our models classify pictures into 1000 different categories. Write a function that takes the models predictions (in the same format as <code>preds</code> from the set-up code) and returns a list of <code>True</code> and <code>False</code> values.</p> <p>Some tips:</p> <ul><li>Work iteratively. Figure out one line at a time outsie the function, and print that line's output to make sure it's right. Once you have all the code you need, move it into the function <code>is_hot_dog</code>. If you get an error, check that you have copied the right code and haven't left anything out.</li> <li>The raw data we loaded in <code>img_paths</code> had two images of hot dogs, followed by two images of other foods. So, if you run your function on <code>preds</code>, which represents the output of the model on these images, your function should return <code>[True, True, False, False]</code>.</li> <li>You will want to use the <code>decode_predictions</code> function that was also used in the code provided above. We provided a line with this in the code cell to get you started.</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Experiment with code outside the function, then move it into the function once you think it is right</span>

<span class="token comment"># the following lines are given as a hint to get you started</span>
decoded <span class="token operator">=</span> decode_predictions<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>decoded<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">is_hot_dog</span><span class="token punctuation">(</span>preds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    inputs:
    preds_array:  array of predictions from pre-trained model

    outputs:
    is_hot_dog_list: a list indicating which predictions show hotdog as the most likely label
    '''</span>
    res<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    most_likely_labels <span class="token operator">=</span> decode_predictions<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> most_likely_label <span class="token keyword">in</span> most_likely_labels<span class="token punctuation">:</span>
        <span class="token keyword">if</span> most_likely_label<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'hotdog'</span><span class="token punctuation">:</span>
            res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res
        
q_1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>Solution</strong>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">is_hot_dog</span><span class="token punctuation">(</span>preds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    decoded <span class="token operator">=</span> decode_predictions<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># pull out predicted label, which is in d[0][1] due to how decode_predictions structures results</span>
    labels <span class="token operator">=</span> <span class="token punctuation">[</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> d <span class="token keyword">in</span> decoded<span class="token punctuation">]</span>
    out <span class="token operator">=</span> <span class="token punctuation">[</span>l <span class="token operator">==</span> <span class="token string">'hotdog'</span> <span class="token keyword">for</span> l <span class="token keyword">in</span> labels<span class="token punctuation">]</span>
    <span class="token keyword">return</span> out
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="exercise-2-evaluate-model-accuracy"><a href="#exercise-2-evaluate-model-accuracy" class="header-anchor">#</a> Exercise 2: Evaluate Model Accuracy</h4> <p>You have a model (called <code>my_model</code>). Is it good enough to build your app around?</p> <p>Find out by writing a function that calculates a model's accuracy (fraction correct). You will try an alternative model in the next step. So we will put this logic in a reusable function that takes data and the model as arguments, and returns the accuracy.</p> <p>Tips:</p> <ul><li>Use the <code>is_hot_dog</code> function from above to help write your function</li> <li>To save you some scrolling, here is the code from above where we used a TensorFlow model to make predictions:</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>my_model <span class="token operator">=</span> ResNet50<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels.h5'</span><span class="token punctuation">)</span>
test_data <span class="token operator">=</span> read_and_prep_images<span class="token punctuation">(</span>img_paths<span class="token punctuation">)</span>
preds <span class="token operator">=</span> my_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">calc_accuracy</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> paths_to_hotdog_images<span class="token punctuation">,</span> paths_to_other_images<span class="token punctuation">)</span><span class="token punctuation">:</span>
    hotdog_data <span class="token operator">=</span> read_and_prep_images<span class="token punctuation">(</span>paths_to_hotdog_images<span class="token punctuation">)</span>
    hotdog_preds <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>hotdog_data<span class="token punctuation">)</span>
    other_data <span class="token operator">=</span> read_and_prep_images<span class="token punctuation">(</span>paths_to_other_images<span class="token punctuation">)</span>
    other_preds <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>other_data<span class="token punctuation">)</span>
    correct_preds<span class="token operator">=</span><span class="token builtin">sum</span><span class="token punctuation">(</span>is_hot_dog<span class="token punctuation">(</span>hotdog_preds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>is_hot_dog<span class="token punctuation">(</span>other_preds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">sum</span><span class="token punctuation">(</span>is_hot_dog<span class="token punctuation">(</span>other_preds<span class="token punctuation">)</span><span class="token punctuation">)</span>
    all_preds<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>is_hot_dog<span class="token punctuation">(</span>hotdog_preds<span class="token punctuation">)</span><span class="token operator">+</span>is_hot_dog<span class="token punctuation">(</span>other_preds<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> correct_preds<span class="token operator">/</span>all_preds
    
<span class="token comment"># Code to call calc_accuracy.  my_model, hot_dog_paths and not_hot_dog_paths were created in the setup code</span>
my_model_accuracy <span class="token operator">=</span> calc_accuracy<span class="token punctuation">(</span>my_model<span class="token punctuation">,</span> hot_dog_paths<span class="token punctuation">,</span> not_hot_dog_paths<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Fraction correct in small test set: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>my_model_accuracy<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># checks that your function calc_accuracy works correctly</span>
q_2<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>Solution:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">calc_accuracy</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> paths_to_hotdog_images<span class="token punctuation">,</span> paths_to_other_images<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># We'll use the counts for denominator of accuracy calculation</span>
    num_hot_dog_images <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>paths_to_hotdog_images<span class="token punctuation">)</span>
    num_other_images <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>paths_to_other_images<span class="token punctuation">)</span>

    hotdog_image_data <span class="token operator">=</span> read_and_prep_images<span class="token punctuation">(</span>paths_to_hotdog_images<span class="token punctuation">)</span>
    preds_for_hotdogs <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>hotdog_image_data<span class="token punctuation">)</span>
    <span class="token comment"># Summing list of binary variables gives a count of True values</span>
    num_correct_hotdog_preds <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>is_hot_dog<span class="token punctuation">(</span>preds_for_hotdogs<span class="token punctuation">)</span><span class="token punctuation">)</span>

    other_image_data <span class="token operator">=</span> read_and_prep_images<span class="token punctuation">(</span>paths_to_other_images<span class="token punctuation">)</span>
    preds_other_images <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>other_image_data<span class="token punctuation">)</span>
    <span class="token comment"># Number correct is the number judged not to be hot dogs</span>
    num_correct_other_preds <span class="token operator">=</span> num_other_images <span class="token operator">-</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>is_hot_dog<span class="token punctuation">(</span>preds_other_images<span class="token punctuation">)</span><span class="token punctuation">)</span>

    total_correct <span class="token operator">=</span> num_correct_hotdog_preds <span class="token operator">+</span> num_correct_other_preds
    total_preds <span class="token operator">=</span> num_hot_dog_images <span class="token operator">+</span> num_other_images
    <span class="token keyword">return</span> total_correct <span class="token operator">/</span> total_preds
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="exercise-3"><a href="#exercise-3" class="header-anchor">#</a> Exercise 3:</h4> <p>There are other models besides the ResNet model (which we have loaded). For example, an earlier winner of the ImageNet competition is the VGG16 model.  Don't worry about the differences between these models yet. We'll come back to that later. For now, just focus on the mechanics of applying these models to a problem.</p> <p>The code used to load a pretrained ResNet50 model was</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>my_model = ResNet50(weights='../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels.h5')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The weights for the model are stored at <code>../input/vgg16/vgg16_weights_tf_dim_ordering_tf_kernels.h5</code>.</p> <p>In the cell below, create a VGG16 model with the preloaded weights. Then use your <code>calc_accuracy</code> function to determine what fraction of images the VGG16 model correctly classifies.  Is it better or worse than the pretrained ResNet model?</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># import the model</span>
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications <span class="token keyword">import</span> VGG16


vgg16_model <span class="token operator">=</span> VGG16<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'../input/vgg16/vgg16_weights_tf_dim_ordering_tf_kernels.h5'</span><span class="token punctuation">)</span>
<span class="token comment"># calculate accuracy on small dataset as a test</span>
vgg16_accuracy <span class="token operator">=</span> calc_accuracy<span class="token punctuation">(</span>vgg16_model<span class="token punctuation">,</span> hot_dog_paths<span class="token punctuation">,</span> not_hot_dog_paths<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Fraction correct in small dataset: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>vgg16_accuracy<span class="token punctuation">)</span><span class="token punctuation">)</span>
q_3<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>If this model is used for an app that runs on a phone, what factors besides accuracy might you care about? After you've thought about it, keep going below.</p> <h2 id="_4-transfer-learning"><a href="#_4-transfer-learning" class="header-anchor">#</a> 4. Transfer Learning</h2> <h3 id="intro-6"><a href="#intro-6" class="header-anchor">#</a> Intro</h3> <p><strong>This is Lesson 4 in the <a href="https://www.kaggle.com/learn/deep-learning" target="_blank" rel="noopener noreferrer">Deep Learning<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> track</strong></p> <p>At the end of this lesson, you will be able to use transfer learning to build highly accurate computer vision models for your custom purposes, even when you have relatively little data.</p> <h3 id="lesson-4"><a href="#lesson-4" class="header-anchor">#</a> Lesson</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> YouTubeVideo
YouTubeVideo<span class="token punctuation">(</span><span class="token string">'mPFq5KMxKVw'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;iframe width=100% height=320 src=&quot;https://www.youtube.com/embed/mPFq5KMxKVw&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="sample-code-2"><a href="#sample-code-2" class="header-anchor">#</a> Sample Code</h3> <h4 id="specify-model"><a href="#specify-model" class="header-anchor">#</a> Specify Model</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications <span class="token keyword">import</span> ResNet50
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> GlobalAveragePooling2D

num_classes <span class="token operator">=</span> <span class="token number">2</span>
resnet_weights_path <span class="token operator">=</span> <span class="token string">'../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5'</span>

my_new_model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
my_new_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>ResNet50<span class="token punctuation">(</span>include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> pooling<span class="token operator">=</span><span class="token string">'avg'</span><span class="token punctuation">,</span> weights<span class="token operator">=</span>resnet_weights_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
my_new_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Say not to train first layer (ResNet) model. It is already trained</span>
my_new_model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="compile-model"><a href="#compile-model" class="header-anchor">#</a> Compile Model</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code>my_new_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'sgd'</span><span class="token punctuation">,</span> loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="fit-model"><a href="#fit-model" class="header-anchor">#</a> Fit Model</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> preprocess_input
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> ImageDataGenerator

image_size <span class="token operator">=</span> <span class="token number">224</span>
data_generator <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>preprocessing_function<span class="token operator">=</span>preprocess_input<span class="token punctuation">)</span>


train_generator <span class="token operator">=</span> data_generator<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>
        <span class="token string">'../input/urban-and-rural-photos/rural_and_urban_photos/train'</span><span class="token punctuation">,</span>
        target_size<span class="token operator">=</span><span class="token punctuation">(</span>image_size<span class="token punctuation">,</span> image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>
        batch_size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span>
        class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">)</span>

validation_generator <span class="token operator">=</span> data_generator<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>
        <span class="token string">'../input/urban-and-rural-photos/rural_and_urban_photos/val'</span><span class="token punctuation">,</span>
        target_size<span class="token operator">=</span><span class="token punctuation">(</span>image_size<span class="token punctuation">,</span> image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>
        class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">)</span>

my_new_model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>
        train_generator<span class="token punctuation">,</span>
        steps_per_epoch<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
        validation_data<span class="token operator">=</span>validation_generator<span class="token punctuation">,</span>
        validation_steps<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h4 id="note-on-results"><a href="#note-on-results" class="header-anchor">#</a> Note on Results:</h4> <p>The printed validation accuracy can be meaningfully better than the training accuracy at this stage. This can be puzzling at first.</p> <p>It occurs because the training accuracy was calculated at multiple points as the network was improving (the numbers in the convolutions were being updated to make the model more accurate). The network was inaccurate when the model saw the first training images, since the weights hadn't been trained/improved much yet. Those first training results were averaged into the measure above.</p> <p>The validation loss and accuracy measures were calculated <strong>after</strong> the model had gone through all the data. So the network had been fully trained when these scores were calculated.</p> <p>This isn't a serious issue in practice, and we tend not to worry about it.</p> <h3 id="exercise-transfer-learning"><a href="#exercise-transfer-learning" class="header-anchor">#</a> Exercise: Transfer Learning</h3> <p><strong><a href="https://www.kaggle.com/kernels/fork/532365" target="_blank" rel="noopener noreferrer">Try transfer learning<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> yourself.</p> <h4 id="exercise-introduction"><a href="#exercise-introduction" class="header-anchor">#</a> Exercise Introduction</h4> <p>The cameraman who shot our deep learning videos mentioned a problem that we can solve with deep learning.</p> <p>He offers a service that scans photographs to store them digitally.  He uses a machine that quickly scans many photos. But depending on the orientation of the original photo, many images are digitized sideways.  He fixes these manually, looking at each photo to determine which ones to rotate.</p> <p>In this exercise, you will build a model that distinguishes which photos are sideways and which are upright, so an app could automatically rotate each image if necessary.</p> <p>If you were going to sell this service commercially, you might use a large dataset to train the model. But you'll have great success with even a small dataset.  You'll work with a small dataset of dog pictures, half of which are rotated sideways.</p> <p>Specifying and compiling the model look the same as in the example you've seen. But you'll need to make some changes to fit the model.</p> <p><strong>Run the following cell to set up automatic feedback.</strong></p> <h4 id="_1-specify-the-model"><a href="#_1-specify-the-model" class="header-anchor">#</a> 1) Specify the Model</h4> <p>Since this is your first time, we'll provide some starter code for you to modify. You will probably copy and modify code the first few times you work on your own projects.</p> <p>There are some important parts left blank in the following code.</p> <p>Fill in the blanks (marked with <code>____</code>) and run the cell</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications <span class="token keyword">import</span> ResNet50
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> GlobalAveragePooling2D

num_classes <span class="token operator">=</span> <span class="token number">2</span>
resnet_weights_path <span class="token operator">=</span> <span class="token string">'../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5'</span>

my_new_model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
my_new_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>ResNet50<span class="token punctuation">(</span>include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> pooling<span class="token operator">=</span><span class="token string">'avg'</span><span class="token punctuation">,</span> weights<span class="token operator">=</span>resnet_weights_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
my_new_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Indicate whether the first layer should be trained/changed or not.</span>
my_new_model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>

step_1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_2-compile-the-model"><a href="#_2-compile-the-model" class="header-anchor">#</a> 2) Compile the Model</h4> <p>You now compile the model with the following line.  Run this cell.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>my_new_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'sgd'</span><span class="token punctuation">,</span> 
                     loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> 
                     metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>That ran nearly instantaneously.  Deep learning models have a reputation for being computationally demanding.  Why did that run so quickly?</p> <p>After thinking about this, check your answer by uncommenting the cell below.</p> <p><strong>Solution</strong>: The compile model doesn't change the values in any convolutions. In fact, your model has not even received an argument with data yet. Compile specifies how your model will make updates a later <code>fit</code> step where it receives data. That is the part that will take longer.</p> <h4 id="_3-review-the-compile-step"><a href="#_3-review-the-compile-step" class="header-anchor">#</a> 3) Review the Compile Step</h4> <p>You provided three arguments in the compile step.</p> <ul><li>optimizer</li> <li>loss</li> <li>metrics</li></ul> <p>Which arguments could affect the accuracy of the predictions that come out of the model?  After you have your answer, run the cell below to see the solution.</p> <p><strong>Solution</strong>:</p> <ul><li><strong>optimizer</strong> determines how we determine the numerical values that make up the model. So it can affect the resulting model and predictions</li> <li><strong>loss</strong> determines what goal we optimize when determining numerical values in the model. So it can affect the resulting model and predictions</li> <li><strong>metrics</strong> determines only what we print out while the model is being built, but it doesn't affect the model itself.</li></ul> <p>You may not understand all of this yet. That's totally fine for now. It will become clearer in an upcoming lesson (called A Deeper Understanding of Deep Learning).</p> <h4 id="_4-fit-model"><a href="#_4-fit-model" class="header-anchor">#</a> 4) Fit Model</h4> <p><strong>Your training data is in the directory <code>../input/dogs-gone-sideways/images/train</code>. The validation data is in <code>../input/dogs-gone-sideways/images/val</code></strong>. Use that information when setting up <code>train_generator</code> and <code>validation_generator</code>.</p> <p>You have 220 images of training data and 217 of validation data.  For the training generator, we set a batch size of 10. Figure out the appropriate value of <code>steps_per_epoch</code> in your <code>fit_generator</code> call.</p> <p>Fill in all the blanks (again marked as <code>____</code>).  Then run the cell of code.  Watch as your model trains the weights and the accuracy improves.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> preprocess_input
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> ImageDataGenerator

image_size <span class="token operator">=</span> <span class="token number">224</span>
data_generator <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>preprocess_input<span class="token punctuation">)</span>

train_generator <span class="token operator">=</span> data_generator<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>
                                        directory<span class="token operator">=</span><span class="token string">'../input/dogs-gone-sideways/images/train'</span><span class="token punctuation">,</span>
                                        target_size<span class="token operator">=</span><span class="token punctuation">(</span>image_size<span class="token punctuation">,</span> image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                        batch_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>
                                        class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">)</span>

validation_generator <span class="token operator">=</span> data_generator<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>
                                        directory<span class="token operator">=</span><span class="token string">'../input/dogs-gone-sideways/images/val'</span><span class="token punctuation">,</span>
                                        target_size<span class="token operator">=</span><span class="token punctuation">(</span>image_size<span class="token punctuation">,</span> image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                        class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">)</span>

<span class="token comment"># fit_stats below saves some statistics describing how model fitting went</span>
<span class="token comment"># the key role of the following line is how it changes my_new_model by fitting to data</span>
fit_stats <span class="token operator">=</span> my_new_model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>train_generator<span class="token punctuation">,</span>
                                       steps_per_epoch<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">,</span>
                                       validation_data<span class="token operator">=</span>validation_generator<span class="token punctuation">,</span>
                                       validation_steps<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

step_4<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>Can you tell from the results what fraction of the time your model was correct in the validation data?</p> <p>In the next step, we'll see if we can improve on that.</p> <h2 id="_5-data-augmentation"><a href="#_5-data-augmentation" class="header-anchor">#</a> 5. Data Augmentation</h2> <h3 id="intro-7"><a href="#intro-7" class="header-anchor">#</a> Intro</h3> <p>At the end of this lesson, you will be able to use data augmentation. This trick that makes it seem like you have far more data than you actually have, resulting in even better models..</p> <h3 id="lesson-5"><a href="#lesson-5" class="header-anchor">#</a> Lesson</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> YouTubeVideo
YouTubeVideo<span class="token punctuation">(</span><span class="token string">'ypt_BAotCLo'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;iframe width=100% height=320 src=&quot;https://www.youtube.com/embed/ypt_BAotCLo&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="sample-code-3"><a href="#sample-code-3" class="header-anchor">#</a> Sample Code</h3> <p>We have some model set-up code which you've seen before. It's not our focus for the moment, so it is hidden (but optionally visible by clicking the &quot;code&quot; button below.)</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications <span class="token keyword">import</span> ResNet50
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> GlobalAveragePooling2D

num_classes <span class="token operator">=</span> <span class="token number">2</span>
resnet_weights_path <span class="token operator">=</span> <span class="token string">'../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5'</span>

my_new_model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
my_new_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>ResNet50<span class="token punctuation">(</span>include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> pooling<span class="token operator">=</span><span class="token string">'avg'</span><span class="token punctuation">,</span> weights<span class="token operator">=</span>resnet_weights_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
my_new_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Say not to train first layer (ResNet) model. It is already trained</span>
my_new_model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>

my_new_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'sgd'</span><span class="token punctuation">,</span> loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="fitting-a-model-with-data-augmentation"><a href="#fitting-a-model-with-data-augmentation" class="header-anchor">#</a> Fitting a Model With Data Augmentation</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code>!ls <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token builtin">input</span><span class="token operator">/</span>urban<span class="token operator">-</span><span class="token keyword">and</span><span class="token operator">-</span>rural<span class="token operator">-</span>photos<span class="token operator">/</span>rural_and_urban_photos
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> preprocess_input
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> ImageDataGenerator

image_size <span class="token operator">=</span> <span class="token number">224</span>

data_generator_with_aug <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>preprocessing_function<span class="token operator">=</span>preprocess_input<span class="token punctuation">,</span>
                                   horizontal_flip<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                   width_shift_range <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
                                   height_shift_range <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">)</span>

train_generator <span class="token operator">=</span> data_generator_with_aug<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>
        <span class="token string">'../input/urban-and-rural-photos/rural_and_urban_photos/train'</span><span class="token punctuation">,</span>
        target_size<span class="token operator">=</span><span class="token punctuation">(</span>image_size<span class="token punctuation">,</span> image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>
        batch_size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span>
        class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">)</span>

data_generator_no_aug <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>preprocessing_function<span class="token operator">=</span>preprocess_input<span class="token punctuation">)</span>
validation_generator <span class="token operator">=</span> data_generator_no_aug<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>
        <span class="token string">'../input/urban-and-rural-photos/rural_and_urban_photos/val'</span><span class="token punctuation">,</span>
        target_size<span class="token operator">=</span><span class="token punctuation">(</span>image_size<span class="token punctuation">,</span> image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>
        class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">)</span>

my_new_model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>
        train_generator<span class="token punctuation">,</span>
        steps_per_epoch<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
        epochs<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
        validation_data<span class="token operator">=</span>validation_generator<span class="token punctuation">,</span>
        validation_steps<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="exercise-data-augmentation"><a href="#exercise-data-augmentation" class="header-anchor">#</a> Exercise: Data Augmentation</h3> <p>Move on to <strong><a href="https://www.kaggle.com/kernels/fork/536195" target="_blank" rel="noopener noreferrer">apply data augmentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> yourself.</p> <h4 id="exercise-introduction-2"><a href="#exercise-introduction-2" class="header-anchor">#</a> Exercise Introduction</h4> <p>We will return to the automatic rotation problem you worked on in the previous exercise. But we'll add data augmentation to improve your model.</p> <p>The model specification and compilation steps don't change when you start using data augmentation. The code you've already worked with for specifying and compiling a model is in the cell below.  Run it so you'll be ready to work on data augmentation.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications <span class="token keyword">import</span> ResNet50
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> GlobalAveragePooling2D

num_classes <span class="token operator">=</span> <span class="token number">2</span>
resnet_weights_path <span class="token operator">=</span> <span class="token string">'../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5'</span>

my_new_model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
my_new_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>ResNet50<span class="token punctuation">(</span>include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> pooling<span class="token operator">=</span><span class="token string">'avg'</span><span class="token punctuation">,</span> weights<span class="token operator">=</span>resnet_weights_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
my_new_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

my_new_model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>

my_new_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'sgd'</span><span class="token punctuation">,</span> loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Set up code checking</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>core <span class="token keyword">import</span> binder
binder<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>deep_learning<span class="token punctuation">.</span>exercise_5 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup Complete&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="_1-fit-the-model-using-data-augmentation"><a href="#_1-fit-the-model-using-data-augmentation" class="header-anchor">#</a> 1) Fit the Model Using Data Augmentation</h4> <p>Here is some code to set up some ImageDataGenerators. Run it, and then answer the questions below about it.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> preprocess_input
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> ImageDataGenerator

image_size <span class="token operator">=</span> <span class="token number">224</span>

<span class="token comment"># Specify the values for all arguments to data_generator_with_aug.</span>
data_generator_with_aug <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>preprocessing_function<span class="token operator">=</span>preprocess_input<span class="token punctuation">,</span>
                                              horizontal_flip <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
                                              width_shift_range <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
                                              height_shift_range <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span>
            
data_generator_no_aug <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>preprocessing_function<span class="token operator">=</span>preprocess_input<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Why do we need both a generator with augmentation and a generator without augmentation? After thinking about it, check out the solution below.</p> <p><strong>Solution</strong>: We want to do data augmentation when fitting the model for the reasons mentioned in the video (including a reduction in overfitting, by giving us more data to work with).</p> <p>But we don't want to change how we test the model. So the validation generator will use an ImageDataGenerator without augmentation. That allows a straightforward comparison between different training procedures (e.g. training with augmentation and without it).</p> <p>If the augmentation made it harder to predict the label associated with an image (e.g. because of how the image was cropped in augmentation) that would make it misleading to compare scores to another procedure where the validation data was only original images.</p> <h4 id="_2-choosing-augmentation-types"><a href="#_2-choosing-augmentation-types" class="header-anchor">#</a> 2) Choosing Augmentation Types</h4> <p>ImageDataGenerator offers many types of data augmentation. For example, one argument is <code>rotation_range</code>. This rotates each image by a random amount that can be up to whatever value you specify.</p> <p>Would it be sensible to use automatic rotation for this problem?  Why or why not?</p> <p><strong>Solution</strong>: The goal in this problem is to tell if an image is upright or sideways. Rotating images moderately might cause images that don't feel cleanly in either category.</p> <p>Since data augmentation affects images without touching the labels, a dramatic rotation would mean some images are used for training with the wrong label (e.g. an image would be rotated sideways by the generator, and still have a label of being upright)</p> <h4 id="_3-code"><a href="#_3-code" class="header-anchor">#</a> 3) Code</h4> <p>Fill in the missing pieces in the following code. We've supplied some boilerplate. You need to think about what ImageDataGenerator is used for each data source.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Specify which type of ImageDataGenerator above is to load in training data</span>
train_generator <span class="token operator">=</span> data_generator_with_aug<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>
        directory <span class="token operator">=</span> <span class="token string">'../input/dogs-gone-sideways/images/train'</span><span class="token punctuation">,</span>
        target_size<span class="token operator">=</span><span class="token punctuation">(</span>image_size<span class="token punctuation">,</span> image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>
        batch_size<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>
        class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">)</span>

<span class="token comment"># Specify which type of ImageDataGenerator above is to load in validation data</span>
validation_generator <span class="token operator">=</span> data_generator_no_aug<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>
        directory <span class="token operator">=</span> <span class="token string">'../input/dogs-gone-sideways/images/val'</span><span class="token punctuation">,</span>
        target_size<span class="token operator">=</span><span class="token punctuation">(</span>image_size<span class="token punctuation">,</span> image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>
        class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">)</span>

my_new_model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>
        train_generator<span class="token punctuation">,</span> <span class="token comment"># if you don't know what argument goes first, try the hint</span>
        epochs <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
        steps_per_epoch<span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">,</span>
        validation_data<span class="token operator">=</span>validation_generator<span class="token punctuation">)</span>

q_3<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="_4-did-data-augmentation-help"><a href="#_4-did-data-augmentation-help" class="header-anchor">#</a> 4) Did Data Augmentation Help?</h4> <p>How could you test whether data augmentation improved your model accuracy?</p> <p><strong>Solution</strong>: Create <code>train_generator</code> usng <code>data_generator_no_aug</code> but don't change other arguments to <code>train_generator</code>.</p> <p>Run the model and see the resuling accuracy. Compare this to the accuracy you got when <code>train_generator</code> used augmentation.</p> <p>Our validation dataset is very small, so there's a little bit of luck or randomness in the exact score from any model run. Validation scores will be more reliable as you start using larger datasets.</p> <h2 id="_6-a-deeper-understanding-of-deep-learning"><a href="#_6-a-deeper-understanding-of-deep-learning" class="header-anchor">#</a> 6. A Deeper Understanding of Deep Learning</h2> <h3 id="intro-8"><a href="#intro-8" class="header-anchor">#</a> Intro</h3> <p>At the end of this lesson, you will understand how stochastic gradient descent and back-propagation are used to set the weights in a deep learning model. These topics are complex, but many experts view them as the most important ideas in deep learning.</p> <h3 id="lesson-6"><a href="#lesson-6" class="header-anchor">#</a> Lesson</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> YouTubeVideo
YouTubeVideo<span class="token punctuation">(</span><span class="token string">'kQmHaI5Jw1c'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;iframe width=100% height=320 src=&quot;https://www.youtube.com/embed/kQmHaI5Jw1c&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>Links Mentioned</strong></p> <p><strong><a href="https://www.kaggle.com/dansbecker/rectified-linear-units-relu-in-deep-learning" target="_blank" rel="noopener noreferrer">ReLU activation function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <h2 id="_7-deep-learning-from-scratch"><a href="#_7-deep-learning-from-scratch" class="header-anchor">#</a> 7. Deep Learning From Scratch</h2> <h3 id="intro-9"><a href="#intro-9" class="header-anchor">#</a> Intro</h3> <p><strong>This is Lesson 7 in the <a href="https://www.kaggle.com/learn/deep-learning" target="_blank" rel="noopener noreferrer">Deep Learning<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> course</strong></p> <p>The models you've built so far have relied on pre-trained models. But they aren't the ideal solution for many use cases. In this lesson, you will learn how to build totally new models.</p> <h3 id="lesson-7"><a href="#lesson-7" class="header-anchor">#</a> Lesson</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> YouTubeVideo
YouTubeVideo<span class="token punctuation">(</span><span class="token string">'YbNE3zhtsoo'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;iframe width=100% height=320 src=&quot;https://www.youtube.com/embed/YbNE3zhtsoo&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="sample-code-4"><a href="#sample-code-4" class="header-anchor">#</a> Sample Code</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python <span class="token keyword">import</span> keras
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> Conv2D<span class="token punctuation">,</span> Dropout


img_rows<span class="token punctuation">,</span> img_cols <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span>
num_classes <span class="token operator">=</span> <span class="token number">10</span>

<span class="token keyword">def</span> <span class="token function">data_prep</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span><span class="token punctuation">:</span>
    out_y <span class="token operator">=</span> keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>to_categorical<span class="token punctuation">(</span>raw<span class="token punctuation">.</span>label<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span>

    num_images <span class="token operator">=</span> raw<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    x_as_array <span class="token operator">=</span> raw<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    x_shaped_array <span class="token operator">=</span> x_as_array<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>num_images<span class="token punctuation">,</span> img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    out_x <span class="token operator">=</span> x_shaped_array <span class="token operator">/</span> <span class="token number">255</span>
    <span class="token keyword">return</span> out_x<span class="token punctuation">,</span> out_y

train_file <span class="token operator">=</span> <span class="token string">&quot;../input/digit-recognizer/train.csv&quot;</span>
raw_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>train_file<span class="token punctuation">)</span>

x<span class="token punctuation">,</span> y <span class="token operator">=</span> data_prep<span class="token punctuation">(</span>raw_data<span class="token punctuation">)</span>

model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span>
                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>categorical_crossentropy<span class="token punctuation">,</span>
              optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
          batch_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span>
          epochs<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
          validation_split <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="exercise-deep-learning-from-scratch"><a href="#exercise-deep-learning-from-scratch" class="header-anchor">#</a> Exercise: Deep Learning From Scratch</h3> <p>You are ready to <strong><a href="https://www.kaggle.com/kernels/fork/574269" target="_blank" rel="noopener noreferrer">build your own model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>.</p> <h4 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h4> <p>You've seen how to build a model from scratch to identify handwritten digits.  You'll now build a model to identify different types of clothing.  To make models that train quickly, we'll work with very small (low-resolution) images.</p> <p>As an example, your model will take an images like this and identify it as a shoe:</p> <center><img src="https://i.imgur.com/GyXOnSB.png" width="20%" height="20%" alt="shoes"></center> <h4 id="data-preparation"><a href="#data-preparation" class="header-anchor">#</a> Data Preparation</h4> <p>This code is supplied, and you don't need to change it. Just run the cell below.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras

img_rows<span class="token punctuation">,</span> img_cols <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span>
num_classes <span class="token operator">=</span> <span class="token number">10</span>

<span class="token keyword">def</span> <span class="token function">prep_data</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> raw<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
    out_y <span class="token operator">=</span> keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>to_categorical<span class="token punctuation">(</span>y<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span>
    
    x <span class="token operator">=</span> raw<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    num_images <span class="token operator">=</span> raw<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    out_x <span class="token operator">=</span> x<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>num_images<span class="token punctuation">,</span> img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    out_x <span class="token operator">=</span> out_x <span class="token operator">/</span> <span class="token number">255</span>
    <span class="token keyword">return</span> out_x<span class="token punctuation">,</span> out_y

fashion_file <span class="token operator">=</span> <span class="token string">&quot;../input/fashionmnist/fashion-mnist_train.csv&quot;</span>
fashion_data <span class="token operator">=</span> np<span class="token punctuation">.</span>loadtxt<span class="token punctuation">(</span>fashion_file<span class="token punctuation">,</span> skiprows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
x<span class="token punctuation">,</span> y <span class="token operator">=</span> prep_data<span class="token punctuation">(</span>fashion_data<span class="token punctuation">)</span>

<span class="token comment"># Set up code checking</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>core <span class="token keyword">import</span> binder
binder<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>deep_learning<span class="token punctuation">.</span>exercise_7 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup Complete&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="_1-start-the-model"><a href="#_1-start-the-model" class="header-anchor">#</a> 1) Start the model</h4> <p>Create a <code>Sequential</code> model called <code>fashion_model</code>. Don't add layers yet.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> Conv2D

<span class="token comment"># Your Code Here</span>
fashion_model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>

q_1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_2-add-the-first-layer"><a href="#_2-add-the-first-layer" class="header-anchor">#</a> 2) Add the first layer</h4> <p>Add the first <code>Conv2D</code> layer to <code>fashion_model</code>. It should have 12 filters, a kernel_size of 3 and the <code>relu</code> activation function. The first layer always requires that you specify the <code>input_shape</code>.  We have saved the number of rows and columns to the variables <code>img_rows</code> and <code>img_cols</code> respectively, so the input shape in this case is <code>(img_rows, img_cols, 1)</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code here</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
                 activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span>
                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
q_2<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_3-add-the-remaining-layers"><a href="#_3-add-the-remaining-layers" class="header-anchor">#</a> 3) Add the remaining layers</h4> <ol><li>Add 2 more convolutional (<code>Conv2D layers</code>) with 20 filters each, 'relu' activation, and a kernel size of 3. Follow that with a <code>Flatten</code> layer, and then a <code>Dense</code> layer with 100 neurons.</li> <li>Add your prediction layer to <code>fashion_model</code>.  This is a <code>Dense</code> layer.  We alrady have a variable called <code>num_classes</code>.  Use this variable when specifying the number of nodes in this layer. The activation should be <code>softmax</code> (or you will have problems later).</li></ol> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code here</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

q_3<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_4-compile-your-model"><a href="#_4-compile-your-model" class="header-anchor">#</a> 4) Compile Your Model</h4> <p>Compile fashion_model with the <code>compile</code> method.  Specify the following arguments:</p> <ol><li><code>loss = &quot;categorical_crossentropy&quot;</code></li> <li><code>optimizer = 'adam'</code></li> <li><code>metrics = ['accuracy']</code></li></ol> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code to compile the model in this cell</span>
fashion_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>categorical_crossentropy<span class="token punctuation">,</span>
              optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
q_4<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_5-fit-the-model"><a href="#_5-fit-the-model" class="header-anchor">#</a> 5) Fit The Model</h4> <p>Run the command <code>fashion_model.fit</code>. The arguments you will use are</p> <ol><li>The data used to fit the model. First comes the data holding the images, and second is the data with the class labels to be predicted. Look at the first code cell (which was supplied to you) where we called <code>prep_data</code> to find the variable names for these.</li> <li><code>batch_size = 100</code></li> <li><code>epochs = 4</code></li> <li><code>validation_split = 0.2</code></li></ol> <p>When you run this command, you can watch your model start improving.  You will see validation accuracies after each epoch.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code to fit the model here</span>
fashion_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
          batch_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
          epochs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
          validation_split <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
q_5<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_6-create-a-new-model"><a href="#_6-create-a-new-model" class="header-anchor">#</a> 6) Create A New Model</h4> <p>Create a new model called <code>second_fashion_model</code> in the cell below.  Make some changes so it is different than <code>fashion_model</code> that you've trained above. The change could be using a different number of layers, different number of convolutions in the layers, etc.</p> <p>Define the model, compile it and fit it in the cell below.  See how it's validation score compares to that of the original model.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Your code below</span>
second_fashion_model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
second_fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>
                         activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span>
                         kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
                         input_shape <span class="token operator">=</span> <span class="token punctuation">(</span>img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Changed kernel sizes to be 2</span>
second_fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
second_fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># added an addition Conv2D layer</span>
second_fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
second_fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
second_fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># It is important not to change the last layer. First argument matches number of classes. Softmax guarantees we get reasonable probabilities</span>
second_fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

second_fashion_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span>
                             optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
                             metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

second_fashion_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> validation_split<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>

q_6<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_8-dropout-and-strides-for-larger-models"><a href="#_8-dropout-and-strides-for-larger-models" class="header-anchor">#</a> 8. Dropout and Strides for Larger Models</h2> <h3 id="intro-10"><a href="#intro-10" class="header-anchor">#</a> Intro</h3> <p><strong>This is Lesson 8 in the <a href="https://www.kaggle.com/learn/deep-learning" target="_blank" rel="noopener noreferrer">Deep Learning<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> track</strong></p> <p>At the end of this lesson, you will understand and know how to use</p> <ul><li><strong>Stride lengths</strong> to make your model faster and reduce memory consumption</li> <li><strong>Dropout</strong> to combat overfitting</li></ul> <p>Both of these techniques are especially useful in large models.</p> <h3 id="lesson-8"><a href="#lesson-8" class="header-anchor">#</a> Lesson</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> YouTubeVideo
YouTubeVideo<span class="token punctuation">(</span><span class="token string">'fwNLf4t7MR8'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;iframe width=100% height=320 src=&quot;https://www.youtube.com/embed/fwNLf4t7MR8&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="sample-code-5"><a href="#sample-code-5" class="header-anchor">#</a> Sample Code</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python <span class="token keyword">import</span> keras
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> Conv2D<span class="token punctuation">,</span> Dropout

img_rows<span class="token punctuation">,</span> img_cols <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span>
num_classes <span class="token operator">=</span> <span class="token number">10</span>

<span class="token keyword">def</span> <span class="token function">data_prep</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span><span class="token punctuation">:</span>
    out_y <span class="token operator">=</span> keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>to_categorical<span class="token punctuation">(</span>raw<span class="token punctuation">.</span>label<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span>

    num_images <span class="token operator">=</span> raw<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    x_as_array <span class="token operator">=</span> raw<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    x_shaped_array <span class="token operator">=</span> x_as_array<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>num_images<span class="token punctuation">,</span> img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    out_x <span class="token operator">=</span> x_shaped_array <span class="token operator">/</span> <span class="token number">255</span>
    <span class="token keyword">return</span> out_x<span class="token punctuation">,</span> out_y

train_size <span class="token operator">=</span> <span class="token number">30000</span>
train_file <span class="token operator">=</span> <span class="token string">&quot;../input/digit-recognizer/train.csv&quot;</span>
raw_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>train_file<span class="token punctuation">)</span>

x<span class="token punctuation">,</span> y <span class="token operator">=</span> data_prep<span class="token punctuation">(</span>raw_data<span class="token punctuation">)</span>

model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                 activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span>
                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>categorical_crossentropy<span class="token punctuation">,</span>
              optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
          batch_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span>
          epochs<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
          validation_split <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="exercise-dropout-and-strides-for-larger-models"><a href="#exercise-dropout-and-strides-for-larger-models" class="header-anchor">#</a> Exercise: Dropout and Strides for Larger Models</h3> <p><strong><a href="https://www.kaggle.com/kernels/fork/663261" target="_blank" rel="noopener noreferrer">Apply dropout and strides<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> yourself while experimenting with larger models.</p> <h4 id="introduction-2"><a href="#introduction-2" class="header-anchor">#</a> Introduction</h4> <p>You've built a model to identify clothing types in the <strong>MNIST for Fashion</strong> dataset.  Now you will make your model bigger, specify larger stride lengths and apply dropout. These changes will make your model faster and more accurate.</p> <p>This is a last step in the <strong><a href="https://www.kaggle.com/learn/deep-learning" target="_blank" rel="noopener noreferrer">Deep Learning Track<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>.</p> <h4 id="data-preparation-2"><a href="#data-preparation-2" class="header-anchor">#</a> Data Preparation</h4> <p><strong>Run this cell of code.</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras

<span class="token comment"># Set up code checking</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>core <span class="token keyword">import</span> binder
binder<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> learntools<span class="token punctuation">.</span>deep_learning<span class="token punctuation">.</span>exercise_8 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup Complete&quot;</span><span class="token punctuation">)</span>

img_rows<span class="token punctuation">,</span> img_cols <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span>
num_classes <span class="token operator">=</span> <span class="token number">10</span>

<span class="token keyword">def</span> <span class="token function">prep_data</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> raw<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
    out_y <span class="token operator">=</span> keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>to_categorical<span class="token punctuation">(</span>y<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span>
    
    x <span class="token operator">=</span> raw<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    num_images <span class="token operator">=</span> raw<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    out_x <span class="token operator">=</span> x<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>num_images<span class="token punctuation">,</span> img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    out_x <span class="token operator">=</span> out_x <span class="token operator">/</span> <span class="token number">255</span>
    <span class="token keyword">return</span> out_x<span class="token punctuation">,</span> out_y

fashion_file <span class="token operator">=</span> <span class="token string">&quot;../input/fashionmnist/fashion-mnist_train.csv&quot;</span>
fashion_data <span class="token operator">=</span> np<span class="token punctuation">.</span>loadtxt<span class="token punctuation">(</span>fashion_file<span class="token punctuation">,</span> skiprows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
x<span class="token punctuation">,</span> y <span class="token operator">=</span> prep_data<span class="token punctuation">(</span>fashion_data<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="_1-increasing-stride-size-in-a-layer"><a href="#_1-increasing-stride-size-in-a-layer" class="header-anchor">#</a> 1) Increasing Stride Size in A Layer</h4> <p>Below is a model without strides (or more accurately, with a stride length of 1)</p> <p>Run it. Notice it's accuracy and how long it takes per epoch. Then you will change the stride length in one of the layers.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> Conv2D<span class="token punctuation">,</span> Dropout

batch_size <span class="token operator">=</span> <span class="token number">16</span>

fashion_model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span>
                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

fashion_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>categorical_crossentropy<span class="token punctuation">,</span>
              optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

fashion_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
          batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span>
          epochs<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
          validation_split <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>You have the same code in the cell below, but the model is now called <code>fashion_model_1</code>.  Change the specification of <code>fashion_model_1</code> so the second convolutional layer has a stride length of 2.</p> <p>Run the cell after you have done that. How does the speed and accuracy change compared to the first model you ran above?</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>fashion_model_1 <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
fashion_model_1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span>
                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model_1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model_1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model_1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fashion_model_1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

fashion_model_1<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>categorical_crossentropy<span class="token punctuation">,</span>
              optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

fashion_model_1<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
          batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span>
          epochs<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
          validation_split <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
q_1<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>You should notice that your model training ran about twice as fast, but the accuracy change was trivial.</p> <p>In addition to being faster to train, this model is also faster at making predictions. This is very important in many scenarios. In practice, you'll need to decide whether that type of speed is important in the applications where you eventually apply deep learning models.</p> <p>You could experiment with more layers or more convolutions in each layer. With some fine-tuning, you can build a model that is both faster and more accurate than the original model.</p> <h4 id="congrats"><a href="#congrats" class="header-anchor">#</a> Congrats</h4> <p>You've finished the Deep Learning course.  You have the tools to create and tune computer vision models.</p> <p>If you feel like playing more with this dataset, you can open up a new code cell to experiment with different models (adding dropout, adding layers, etc.)  Or pick a new project and try out your skills.</p> <p>A few fun datasets you might try include:</p> <ul><li><a href="https://www.kaggle.com/olgabelitskaya/classification-of-handwritten-letters" target="_blank" rel="noopener noreferrer">Written letter recognition<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.kaggle.com/alxmamaev/flowers-recognition" target="_blank" rel="noopener noreferrer">Flower Identification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.kaggle.com/c/dogs-vs-cats-redux-kernels-edition" target="_blank" rel="noopener noreferrer">Cats vs Dogs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.kaggle.com/slothkong/10-monkey-species" target="_blank" rel="noopener noreferrer">10 Monkeys<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.kaggle.com/kmader/rsna-bone-age" target="_blank" rel="noopener noreferrer">Predict Bone Age from X-Rays<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>You have learned a lot, and you'll learn it as you practice. Have fun with it!</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/evansyangs/Blog-source-code/edit/vuepress-vdoing/docs/_posts/随笔/Kaggle Deep Learning.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/02/16, 12:50:44</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list no-article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/98bc36/"><div>
            Dell7472黑苹果
            <!----></div></a> <span class="date">03-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/4ca485/"><div>
            上手HackMD
            <!----></div></a> <span class="date">04-13</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/5ce1a4/"><div>
            Windows Terminal设置
            <!----></div></a> <span class="date">03-14</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:isevansyangs@outlook.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/evansyangs" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=634517784" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>Evan Yang</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.f773b411.js" defer></script><script src="/assets/js/2.84387116.js" defer></script><script src="/assets/js/70.d3fa8b6d.js" defer></script>
  </body>
</html>
